{"version":3,"sources":["components/MainApp/Session/Session.module.css","components/PlaybackApp/Player/Player.module.css","components/MainApp/BottomBar/BottomBar.module.css","config/global.js","utils/network.js","components/FeedApp/network.js","config/api.js","components/Login/network.js","components/PlaybackApp/Player/network.js","components/QueueApp/network.js","components/PlaybackApp/utils.js","config/services.js","utils/reducers/feed.js","utils/reducers/marker.js","components/QueueApp/utils.js","utils/reducers/queue.js","utils/reducers/stream.js","utils/reducers/playback.js","utils/reducers/queueInterval.js","utils/reducers/textComment.js","utils/reducers/textCommentModification.js","utils/reducers/voiceRecording.js","utils/reducers/userSettings.js","utils/redux.js","components/PlaybackApp/controls.js","components/Login/Login.js","components/UserSettings/network.js","components/SpotifySync/network.js","components/SpotifySync/SpotifySync.js","components/FeedApp/VoiceRecording/network.js","components/FeedApp/NotableText/constants.js","components/FeedApp/NotableText/network.js","components/FeedApp/NotableText/NotableText.js","components/FeedApp/TextComment/network.js","components/FeedApp/TextComment/TextComment.js","components/FeedApp/ABCNotationDisplay/ABCNotationDisplay.js","components/FeedApp/ABCNotationCompose/ABCNotationCompose.js","components/FeedApp/VoiceRecording/VoiceRecording.js","components/FeedApp/FeedApp.js","config/model.js","components/FeedApp/MiniFeed/MiniFeed.js","components/TrackDetailApp/Marker/network.js","components/TrackDetailApp/Interval/network.js","components/TrackDetailApp/Interval/Interval.js","components/TrackDetailApp/Marker/Marker.js","components/TrackDetailApp/TrackDetailApp.js","components/QueueApp/QueueTrack/QueueTrack.js","components/QueueApp/QueueCollection/QueueCollection.js","components/QueueApp/QueueApp.js","components/QueueApp/MiniQueue/MiniQueue.js","components/SearchApp/network.js","components/SearchApp/SearchResult/icons.js","components/SearchApp/SearchResult/SearchResult.js","components/Upload/network.js","components/Upload/Upload.js","components/SearchApp/SearchApp.js","components/WelcomeApp/icons.js","components/WelcomeApp/WelcomeApp.js","components/PlaybackApp/ChildProgressBar/ChildProgressBar.js","components/PlaybackApp/icons.js","components/PlaybackApp/ParentProgressBar/ParentProgressBar.js","components/PlaybackApp/ParentProgressBar/utils.js","components/PlaybackApp/Player/Player.js","components/PlaybackApp/MiniPlayer/MiniPlayer.js","components/MainApp/BottomBar/icons.js","components/MainApp/BottomBar/BottomBar.js","components/UserSettings/UserSettings.js","components/MainApp/SideBar/icons.js","components/MainApp/SideBar/SideBar.js","components/MainApp/Session/Session.js","components/MainApp/MainApp.js","components/FeedApp/utils.js","components/PlaybackApp/PlaybackApp.js","App.js","reportWebVitals.js","index.js","components/MainApp/SideBar/SideBar.module.css","components/Upload/Upload.module.css","components/QueueApp/QueueCollection/QueueCollection.module.css","components/SearchApp/SearchApp.module.css","components/Login/Login.module.css","components/SearchApp/SearchResult/SearchResult.module.css","components/WelcomeApp/WelcomeApp.module.css","components/PlaybackApp/ChildProgressBar/ChildProgressBar.module.css","components/FeedApp/FeedApp.module.css","components/QueueApp/QueueTrack/QueueTrack.module.css","components/PlaybackApp/ParentProgressBar/ParentProgressBar.module.css","components/QueueApp/QueueApp.module.css","components/QueueApp/MiniQueue/MiniQueue.module.css","components/FeedApp/NotableText/NotableText.module.css","components/FeedApp/TextComment/TextComment.module.css","components/FeedApp/ABCNotationDisplay/ABCNotationDisplay.module.css","components/FeedApp/VoiceRecording/VoiceRecording.module.css","components/FeedApp/MiniFeed/MiniFeed.module.css","components/PlaybackApp/MiniPlayer/MiniPlayer.module.css"],"names":["module","exports","BACKEND_DOMAIN","process","TYPE_GET","TYPE_POST","fetchBackend","a","method","url","data","formData","FormData","Object","entries","key","value","append","requestOptions","headers","token","localStorage","getItem","Authorization","request","Request","fetch","mode","body","response","searchParams","URLSearchParams","set","getUrl","toString","fetchTextCommentCreate","text","format","trackUuid","textCommentTimestamp","json","responseJson","fetchTextCommentList","fetchVoiceRecordingList","fetchAuthToken","username","password","fetchInitializeStream","fetchVerifyToken","status","undefined","fetchStreamGet","fetchTrackGetFiles","fetchNextTrack","nowPlayingTotalDurationMilliseconds","isPlanned","fetchPauseTrack","fetchPlayTrack","fetchPrevTrack","fetchScanBackward","fetchScanForward","fetchQueueList","fetchDeleteQueue","queueUuid","getPositionMilliseconds","stream","startedAt","nowPlaying","progress","isPaused","pausedAt","Date","now","seekTimeout","instrument","playbackIntervalIdx","cumulativeProgress","playbackInterval","playbackIntervals","playbackIntervalDuration","endPosition","startPosition","remainingProgress","purpose","length","cycleVolumeLevel","volumeLevel","SERVICE_APPLE_MUSIC","SERVICE_SPOTIFY","SERVICE_YOUTUBE","SERVICE_JUKEBOX_RADIO","RENDER_STATUS_HIDE","feedGenerate","state","displayThreshold","historyThreshold","textComments","voiceRecordings","aggregateFeed","map","el","shouldTagHistory","timestampMilliseconds","shouldTagDisplay","renderStatus","filter","i","sort","b","track","isPlaying","feedUpdate","feed","markerCreate","action","trackMarkerMap","marker","sortedMarkers","markerDelete","filteredMarkers","m","uuid","markerList","markers","getLastUpQueue","lastUpQueues","getNextUpQueue","nextUpQueues","children","getQueueDuration","queues","getDuration","queue","total","totalDurationMilliseconds","getProgress","reduce","curr","finalizeQueue","copy","editedChildren","q","durationMilliseconds","service","imageUrl","replace","intervals","trackDurationMilliseconds","lowerBound","upperBound","interval","push","audioUuid","queueListSet","payload","_lastPlayed","lastUp","nextUp","queueDeleteNode","filteredQueues","queueDeleteChildNode","parentIndex","findIndex","parentUuid","filteredChildren","streamSet","obj","streamPlay","updatedPayload","streamPause","streamPrevTrack","lastNowPlaying","nextUpQueue","nextNowPlaying","isTrackInCollection","unshift","pop","streamNextTrack","shift","playbackAppleMusic","playback","appleMusic","api","appleMusicApi","isReady","playbackSpotify","spotifyApi","playbackYouTube","youTubeApi","playbackAddToQueue","appleMusicShouldAddToQueue","spotifyShouldAddToQueue","queuedUp","noopNextTrack","playbackPlannedNextTrack","updatedState","addToQueueTimeoutId","nextSeekTimeoutId","clearTimeout","playbackPlannedNextTrackHelper","childPayload","updatedNowPlaying","playbackStart","playbackStarted","playbackAddToQueueReschedule","playbackAddToQueueScheduled","playbackNextSeekScheduled","playbackDisable","controlsEnabled","playbackEnable","playbackLoadFiles","files","audiosObj","all","Audio","audioUrl","stems","stem","playbackCycleVolumeLevelAudio","audioLevel","audio","findByUuid","o","sortQueueIntervals","queueIntervalCreate","index","queueInterval","parentQueueUuid","trackQueue","sortedQueueIntervals","finalizedNextUpQueues","queueIntervalDelete","filteredQueueIntervals","textCommentListSet","textCommentCreate","textComment","textCommentDelete","textCommentUuid","textCommentModificationCreate","existingIdx","textCommentModifications","modifiedModification","modified","deletedModifications","deleted","textCommentIndex","t","modifications","startPtr","idx","deletedModification","textCommentClearModifications","voiceRecordingListSet","voiceRecordingCreate","voiceRecording","voiceRecordingDelete","voiceRecordingUuid","userSettingsUpdate","userSettings","userGetSettings","initialState","voice","store","createStore","type","window","__REDUX_DEVTOOLS_EXTENSION__","trace","playbackControlPause","playbackService","MusicKit","getInstance","player","pause","pauseVideo","audios","paused","playbackControlPlay","play","playVideo","playbackControlSeek","arr","positionMilliseconds","seekToTime","seek","seekTo","instr","aud","currentTime","playbackControlSkipToNext","skipToNextItem","skipToNext","playbackControlQueue","nextPlaybackService","music","prepareToPlay","externalId","playNext","song","then","dispatch","redux","Login","props","useState","setUsername","setPassword","rememberMe","setRememberMe","handleSubmit","e","preventDefault","access","refresh","setItem","location","href","className","styles","onSubmit","FormBlock","name","placeholder","onChange","target","to","fetchGetUserSettings","fetchUpdateUserSettings","field","fetchUserConnectSpotify","code","error","SpotifySync","useEffect","queryString","search","urlParams","get","postData","fetchCreateVoiceRecording","audioFile","transcriptData","transcriptFinal","fetchDeleteVoiceRecording","STYLE_BOLD","STYLE_ITALICIZE","STYLE_STRIKETHROUGH","STYLE_HIGHLIGHT","STYLE_CHOICES","fetchCreateTextCommentModification","style","anchorOffset","focusOffset","connect","textColor","selectableRef","useRef","selectableIsShowable","setSelectableIsShowable","setAnchorOffset","setFocusOffset","handleNotation","onTextSelect","selection","getSelection","anchorValue","parseInt","anchorNode","parentNode","getAttribute","focusValue","focusNode","onTextUnselect","NotableText","color","ref","textCommentText","Set","modification","j","endPtr","add","textCommentHtml","char","stylesObj","has","offset","renderTextComment","selectionRef","isOpen","onClick","fetchDeleteTextComment","fetchListDeleteTextCommentModifications","deleteTextComment","clearModifications","TextComment","abcNotation","abcNotationUuid","deleteAbcNotation","ABCNotationDisplay","notation","engraverParams","staffwidth","closeModal","isDisabled","setIsDisabled","setText","createABCNotation","ariaHideApp","disabled","handleDelete","VoiceRecording","setTrackUuid","setTextCommentTimestamp","isRecording","setIsRecording","MicRecorder","bitRate","recorder","showModal","setShowModal","periodicTask","setInterval","clearInterval","createTextComment","useSpeechRecognition","transcript","resetTranscript","FeedApp","Feed","FeedWrapper","class","CreateTextComment","position","SpeechRecognition","browserSupportsSpeechRecognition","stopListening","stop","getMp3","buffer","blob","file","File","lastModified","JSON","stringify","startListening","continuous","start","MiniFeed","fetchStreamMarkerCreate","fetchStreamMarkerDelete","markerUuid","fetchStreamMarkerList","fetchStreamQueueIntervalCreate","lowerBoundMarkerUuid","upperBoundMarkerUuid","repeatCount","fetchStreamQueueIntervalDelete","queueIntervalUuid","deleteQueueInterval","trackMarker","deleteTrackMarker","shouldOpenModal","setShouldOpenModal","openModal","setPurpose","formMarkerTimestamp","setFormMarkerTimestamp","setLowerBoundMarkerUuid","setUpperBoundMarkerUuid","createTrackMarker","createQueueInterval","loadData","currentIndex","isNextUp","indent","QueueTrack","Button","destroy","isCurrentlyPlayingCollection","reveal","setReveal","toggleReveal","QueueCollection","Item","collection","Children","nowPlayingTrackName","queueDuration","endsAt","destroyQueueItem","QueueApp","ReactTimeAgo","future","date","locale","AddToQueue","flattenedQueue","expandedQueues","flattenedQueues","child","flattenQueues","slice","MiniQueue","MiniQueueItem","fetchSearchMusicLibrary","query","providerAppleMusic","providerSpotify","providerYouTube","providerJukeboxRadio","formatTrack","formatAlbum","formatPlaylist","formatVideo","fetchCreateQueue","genericUuid","iconCheck","width","height","viewBox","fill","xmlns","d","SearchResult","searchResult","addToQueue","isSubmitting","setIsSubmitting","isSubmitted","setIsSubmitted","handleAddToQueue","provider","ggSpinner","fetchCreateTrack","imageFile","trackName","artistName","albumName","Upload","inputKey","setInputKey","setAudioFile","setImageFile","setTrackName","setArtistName","setAlbumName","prev","searchResults","setSearchResults","setQuery","serviceAppleMusic","setServiceAppleMusic","serviceSpotify","setServiceSpotify","serviceYouTube","setServiceYouTube","serviceJukeboxRadio","setServiceJukeboxRadio","setFormatTrack","setFormatAlbum","setFormatPlaylist","setFormatVideo","responseJsonQueueList","SearchApp","SearchBar","onKeyDown","event","checked","SearchResults","iconPlug","fillRule","clipRule","history","useHistory","WelcomeApp","musicUserToken","authorize","spotify","accessToken","authorizationUrl","ChildProgressBar","duration","intervalWidthStyle","progressClass","charAt","toUpperCase","classNames","FirstInterval","LastInterval","ProgressParentMuted","ProgressParentBare","join","iconNextTrack","iconPrevTrack","iconDownTriangle","allIntervals","lastVal","firstIntervalStart","lastIntervalEnd","nowPlayingTrackDuration","getAllIntervals","pointerLeftDistance","setCounter","ParentProgressBar","ProgressPointer","left","ProgressBar","reload","Player","Div","alt","src","Image","prevTrack","nextTrack","MoreNextUp","iconScanForward","enableBackground","points","iconScanBackward","iconPlayCircle","iconPauseCircle","iconMusic","playbackControls","audioVolumeLevel","scanDisabled","playPauseDisabled","displayStartPlayback","displayAddToQueue","handleSeek","direction","BottomBar","ExtraControl","ExtraControlButton","Volume","VolumeButton","nextVolumeLevel","volume","setVolume","drums","vocals","bass","other","playbackChangeVolume","circleRatio","buildStyles","rotation","strokeLinecap","trailColor","Playback","PlaybackButton","idleQueue","speakVoice","focusMode","iconProfile","iconMore","SideBar","Logo","Jb","Menu","Search","Queue","Settings","forceHideModal","setForceHideModal","Session","Top","Content","path","PrimaryContent","SecondaryContent","MainApp","updateFeed","responseJsonTextCommentList","responseJsonVoiceRecordingList","SpotifyWebApi","require","appleMusicSDKReady","setAppleMusicSDKReady","spotifySDKReady","setSpotifySDKReady","spotifySDKDeviceID","setSpotifySDKDeviceID","spotifySDKInit","setSpotifySDKInit","messageScheduleNextTrack","setMessageScheduleNextTrack","plannedNextTrackTimeoutId","setPlannedNextTrackTimeoutId","nextTrackJson","setNextTrackJson","shouldPauseOnTrackChange","nextPlayingQueue","lastPlaybackInterval","setQueue","delayPositionMilliseconds","uris","position_ms","playbackControlStart","responseJsonNextTrack","plannedNextTrack","responseJsonPrevTrack","system","epochNow","getTime","proposedStartedAt","seekTimeoutDuration","seekTimeoutId","setTimeout","jsonResponse","script","document","createElement","async","Promise","resolve","Spotify","onSpotifyWebPlaybackSDKReady","appendChild","appendSpotifySDK","onload","configure","developerToken","app","build","addEventListener","console","log","getOAuthToken","cb","setAccessToken","addListener","device_id","transferMyPlayback","updateSpotifyPlayer","timeLeft","timeoutId","timeoutDuration","videoId","display","opts","playerVars","autoplay","controls","disablekb","fs","iv_load_policy","modestbranding","origin","playsinline","onReady","onPause","onPlay","App","setStatus","nowPlayingTrack","textCommentsJsonResponse","voiceRecordingsJsonResponse","TimeAgo","addDefaultLocale","en","getState","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.7f85f39a.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Session\":\"Session_Session__3G52u\",\"Top\":\"Session_Top__3uCH7\",\"Content\":\"Session_Content__3lPl4\",\"PrimaryContent\":\"Session_PrimaryContent__3yGCf\",\"SecondaryContent\":\"Session_SecondaryContent__1Uvc2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Player\":\"Player_Player__Xx8fy\",\"Div\":\"Player_Div__1Mznx\",\"Button\":\"Player_Button__1lbWu\",\"Image\":\"Player_Image__1PWwp\",\"MoreNextUp\":\"Player_MoreNextUp__2_uZ-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"BottomBar\":\"BottomBar_BottomBar__3MLzc\",\"Playback\":\"BottomBar_Playback__3N-qW\",\"PlaybackButton\":\"BottomBar_PlaybackButton__1axWT\",\"Volume\":\"BottomBar_Volume__25kUh\",\"VolumeButton\":\"BottomBar_VolumeButton__26qBR\",\"ExtraControl\":\"BottomBar_ExtraControl__2zuEs\",\"ExtraControlButton\":\"BottomBar_ExtraControlButton__3Kvpp\"};","const BACKEND_DOMAIN = process.env.REACT_APP_BACKEND_DOMAIN;\nconst TYPE_GET = 'GET';\nconst TYPE_POST = 'POST';\n\nexport { BACKEND_DOMAIN, TYPE_GET, TYPE_POST }\n","import { BACKEND_DOMAIN } from '../config/global'\n\n\nasync function fetchBackend(method = '', url = '', data = {}) {\n  let response;\n\n  url = BACKEND_DOMAIN + url;\n\n  if(method !== 'GET') {\n\n    // aggregate form data in one place\n    const formData = new FormData();\n    for (const [key, value] of Object.entries(data)) {\n      formData.append(key, value);\n    }\n    // for (const [key, value] of Object.entries(files)) {\n    //   formData.append(key, value);\n    // }\n\n    // authenticate request if possible\n    let requestOptions = {headers: {}}\n    const token = localStorage.getItem('accessToken');\n    if(token) {\n      requestOptions.headers.Authorization = `Bearer ${token}`;\n    }\n    const request = new Request(url, requestOptions);\n\n    // make the request\n    response = await fetch(request, {\n      method: method,\n      mode: 'cors',\n      body: formData,\n    });\n  } else {\n\n    // translate form data for GET\n    let searchParams = new URLSearchParams();\n    for (const [key, value] of Object.entries(data)) {\n      searchParams.set(key, value);\n    }\n    const getUrl = url + '/?' + searchParams.toString();\n\n    // authenticate request if possible\n    let requestOptions = {headers: {'Content-Type': 'application/json'}}\n    const token = localStorage.getItem('accessToken');\n    if(token) {\n      requestOptions.headers.Authorization = `Bearer ${token}`;\n    }\n    const request = new Request(getUrl, requestOptions);\n\n    // make the request\n    response = await fetch(request, {\n      method: method,\n      mode: 'cors',\n    });\n  }\n\n  return response;\n}\n\nexport { fetchBackend }\n","import {\n  ENDPOINT_TEXT_COMMENT_CREATE,\n  ENDPOINT_TEXT_COMMENT_LIST,\n  ENDPOINT_VOICE_RECORDING_LIST\n} from '../../config/api'\nimport { TYPE_GET, TYPE_POST } from '../../config/global'\nimport { fetchBackend } from '../../utils/network'\n\n\n/*\n * Fetches...\n */\nexport const fetchTextCommentCreate = async (text, format, trackUuid, textCommentTimestamp) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_TEXT_COMMENT_CREATE,\n    { text, format, trackUuid, textCommentTimestamp },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n/*\n * Fetches...\n */\nexport const fetchTextCommentList = async (trackUuid) => {\n  const response = await fetchBackend(\n    TYPE_GET,\n    ENDPOINT_TEXT_COMMENT_LIST,\n    { trackUuid },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n/*\n * Fetches...\n */\nexport const fetchVoiceRecordingList = async (trackUuid) => {\n  const response = await fetchBackend(\n    TYPE_GET,\n    ENDPOINT_VOICE_RECORDING_LIST,\n    { trackUuid },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","// NOTE: If the API endpoint is a GET, then there is no ending slash.\n//       Else, the endpoint is probably a POST and there should be a slash.\n\n\n// AUTHENTICATION\nexport const ENDPOINT_OBTAIN_TOKENS = '/auth/obtain-tokens/'\nexport const ENDPOINT_REFRESH_TOKEN = '/auth/refresh-token/'\nexport const ENDPOINT_VERIFY_TOKEN = '/auth/verify-token/'\n\n// USER\nexport const ENDPOINT_USER_GET_SETTINGS = '/users/user/get-settings'\nexport const ENDPOINT_USER_UPDATE_SETTINGS = '/users/user/update-settings/'\nexport const ENDPOINT_USER_CONNECT_SPOTIFY = '/users/user/connect-spotify/'\n\n// TEXT COMMENT\nexport const ENDPOINT_TEXT_COMMENT_CREATE = '/comments/text-comment/create/'\nexport const ENDPOINT_TEXT_COMMENT_DELETE = '/comments/text-comment/delete/'\nexport const ENDPOINT_TEXT_COMMENT_LIST = '/comments/text-comment/list'\n\n// TEXT COMMENT MODIFICATION\nexport const ENDPOINT_TEXT_COMMENT_MODIFICATION_CREATE = '/comments/text-comment-modification/create/'\nexport const ENDPOINT_TEXT_COMMENT_MODIFICATION_LIST_DELETE = '/comments/text-comment-modification/list-delete/'\n\n// VOICE RECORDING\nexport const ENDPOINT_VOICE_RECORDING_CREATE = '/comments/voice-recording/create/'\nexport const ENDPOINT_VOICE_RECORDING_DELETE = '/comments/voice-recording/delete/'\nexport const ENDPOINT_VOICE_RECORDING_LIST = '/comments/voice-recording/list'\n\n// TRACK\nexport const ENDPOINT_TRACK_CREATE = '/music/track/create/'\nexport const ENDPOINT_TRACK_GET_FILES = '/music/track/get-files'\n\n// MUSIC\nexport const ENDPOINT_MUSIC_SEARCH = '/music/search'\n\n// QUEUE\nexport const ENDPOINT_QUEUE_CREATE = '/streams/queue/create/'\nexport const ENDPOINT_QUEUE_DELETE = '/streams/queue/delete/'\nexport const ENDPOINT_QUEUE_LIST = '/streams/queue/list'\n\n// STREAM\nexport const ENDPOINT_STREAM_GET = '/streams/stream/get'\nexport const ENDPOINT_STREAM_INITIALIZE = '/streams/stream/initialize/'\nexport const ENDPOINT_STREAM_NEXT_TRACK = '/streams/stream/next-track/'\nexport const ENDPOINT_STREAM_PAUSE_TRACK = '/streams/stream/pause-track/'\nexport const ENDPOINT_STREAM_PLAY_TRACK = '/streams/stream/play-track/'\nexport const ENDPOINT_STREAM_PREV_TRACK = '/streams/stream/prev-track/'\nexport const ENDPOINT_STREAM_SCAN_BACKWARD = '/streams/stream/scan-backward/'\nexport const ENDPOINT_STREAM_SCAN_FORWARD = '/streams/stream/scan-forward/'\n\n// MARKER\nexport const ENDPOINT_MARKER_CREATE = '/streams/marker/create/'\nexport const ENDPOINT_MARKER_DELETE = '/streams/marker/delete/'\nexport const ENDPOINT_MARKER_LIST = '/streams/marker/list'\n\n// QUEUE INTERVAL\nexport const ENDPOINT_QUEUE_INTERVAL_CREATE = '/streams/queue-interval/create/'\nexport const ENDPOINT_QUEUE_INTERVAL_DELETE = '/streams/queue-interval/delete/'\n","import {\n  ENDPOINT_OBTAIN_TOKENS,\n  ENDPOINT_STREAM_INITIALIZE,\n  ENDPOINT_VERIFY_TOKEN,\n} from '../../config/api'\nimport { TYPE_POST } from '../../config/global'\nimport { fetchBackend } from '../../utils/network'\n\n/*\n * Fetches an auth token from the server.\n */\nexport const fetchAuthToken = async (username, password) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_OBTAIN_TOKENS,\n    { username: username, password: password },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n\n/*\n * Fetches an auth token from the server.\n */\nexport const fetchInitializeStream = async () => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_STREAM_INITIALIZE,\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n\n/*\n * Fetches...\n */\nexport const fetchVerifyToken = async () => {\n  const token = localStorage.getItem('accessToken');\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_VERIFY_TOKEN,\n    { token: token }\n  );\n  if(response.status !== 200) {\n    //throw new Error(\"Not logged in!\");\n    return undefined;\n  }\n  const responseJson = await response.json();\n  return responseJson;\n};\n","import {\n  ENDPOINT_STREAM_GET,\n  ENDPOINT_TRACK_GET_FILES,\n  ENDPOINT_STREAM_NEXT_TRACK,\n  ENDPOINT_STREAM_PAUSE_TRACK,\n  ENDPOINT_STREAM_PLAY_TRACK,\n  ENDPOINT_STREAM_PREV_TRACK,\n  ENDPOINT_STREAM_SCAN_BACKWARD,\n  ENDPOINT_STREAM_SCAN_FORWARD,\n} from '../../../config/api'\nimport { TYPE_GET, TYPE_POST } from '../../../config/global'\nimport { fetchBackend } from '../../../utils/network'\n\n\n/*\n * Fetches...\n */\nconst fetchStreamGet = async () => {\n  const response = await fetchBackend(\n    TYPE_GET,\n    ENDPOINT_STREAM_GET,\n  );\n  return await response.json();\n};\n\n\nconst fetchTrackGetFiles = async(trackUuid) => {\n  const response = await fetchBackend(\n    TYPE_GET,\n    ENDPOINT_TRACK_GET_FILES,\n    { trackUuid },\n  );\n  return await response.json();\n}\n\n\n/*\n * Fetches...\n */\nconst fetchNextTrack = async (nowPlayingTotalDurationMilliseconds, isPlanned) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_STREAM_NEXT_TRACK,\n    { nowPlayingTotalDurationMilliseconds, isPlanned }\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n/*\n * Fetches...\n */\nconst fetchPauseTrack = async (nowPlayingTotalDurationMilliseconds) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_STREAM_PAUSE_TRACK,\n    { nowPlayingTotalDurationMilliseconds },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n/*\n * Fetches...\n */\nconst fetchPlayTrack = async () => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_STREAM_PLAY_TRACK,\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n/*\n * Fetches...\n */\nconst fetchPrevTrack = async (nowPlayingTotalDurationMilliseconds) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_STREAM_PREV_TRACK,\n    { nowPlayingTotalDurationMilliseconds },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n/*\n * Fetches...\n */\nconst fetchScanBackward = async (nowPlayingTotalDurationMilliseconds) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_STREAM_SCAN_BACKWARD,\n    { nowPlayingTotalDurationMilliseconds },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n/*\n * Fetches...\n */\nconst fetchScanForward = async (nowPlayingTotalDurationMilliseconds) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_STREAM_SCAN_FORWARD,\n    { nowPlayingTotalDurationMilliseconds }\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\nexport {\n  fetchStreamGet,\n  fetchNextTrack,\n  fetchPauseTrack,\n  fetchPlayTrack,\n  fetchPrevTrack,\n  fetchScanBackward,\n  fetchScanForward,\n  fetchTrackGetFiles,\n}\n","import { ENDPOINT_QUEUE_LIST, ENDPOINT_QUEUE_DELETE } from '../../config/api'\nimport { TYPE_GET, TYPE_POST } from '../../config/global'\nimport { fetchBackend } from '../../utils/network'\n\n/*\n * Fetches...\n */\nexport const fetchQueueList = async () => {\n  const response = await fetchBackend(\n    TYPE_GET,\n    ENDPOINT_QUEUE_LIST,\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n/*\n * Fetches...\n */\nexport const fetchDeleteQueue = async (queueUuid) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_QUEUE_DELETE,\n    { queueUuid: queueUuid },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","/*\n * This gets the position that the track should be at.\n *\n * @return [\n *   progress: Time in milliseconds,\n *   seekTimeout: Time in milliseconds until the next seek should happen,\n * ]\n */\nexport const getPositionMilliseconds = function(stream, startedAt) {\n  if(!stream.nowPlaying) {\n    return [undefined, undefined];\n  }\n\n  let progress;\n  if(stream.isPaused) {\n    progress = stream.pausedAt - startedAt;\n  } else {\n    progress = Date.now() - startedAt;\n  }\n\n  let instrument = 'all',\n      seekTimeout,\n      playbackIntervalIdx = 0,\n      cumulativeProgress = 0;\n  while(true) {\n    const playbackInterval = stream.nowPlaying.playbackIntervals[playbackIntervalIdx],\n          playbackIntervalDuration = playbackInterval.endPosition - playbackInterval.startPosition,\n          remainingProgress = progress - cumulativeProgress;\n    if(remainingProgress < playbackIntervalDuration) {\n      progress = playbackInterval.startPosition + remainingProgress;\n      instrument = playbackInterval.purpose;\n      seekTimeout = playbackInterval.endPosition - progress;\n      break;\n    }\n    playbackIntervalIdx += 1;\n    cumulativeProgress += playbackIntervalDuration;\n  }\n\n  if(playbackIntervalIdx === stream.nowPlaying.playbackIntervals.length - 1) {\n    seekTimeout = undefined;\n  }\n\n  return [progress, seekTimeout, instrument];\n}\n\n\n/*\n * Get the progress of a stream.\n */\nexport const getProgress = function(stream) {\n  if(stream?.isPaused) {\n    return stream.pausedAt - stream.startedAt;\n  } else if(stream?.isPlaying) {\n    return Date.now() - stream.startedAt;\n  } else {\n    return undefined;\n  }\n};\n\n\n/*\n *\n */\nexport const updateSpotifyPlayer = function(playback, device_id) {\n  playback.spotifyApi.transferMyPlayback([device_id])\n}\n\n\nexport const cycleVolumeLevel = function(volumeLevel) {\n  const MUTED = 0.00,\n        LOW = 0.30,\n        HIGH = 0.60,\n        FULL = 1.00;\n  if(volumeLevel > HIGH) {\n    return HIGH;\n  } else if(volumeLevel > LOW) {\n    return LOW;\n  } else if(volumeLevel > MUTED) {\n    return MUTED;\n  } else {\n    return FULL;\n  }\n}\n","export const SERVICE_APPLE_MUSIC = 'apple_music';\nexport const SERVICE_SPOTIFY = 'spotify';\nexport const SERVICE_YOUTUBE = 'youtube';\nexport const SERVICE_JUKEBOX_RADIO = 'jukebox_radio';\n","/*\n * - hide:    A tag given to a feed item which should not be shown.\n * - history: A tag given to a feed item which signifies that it is no longer\n *            relevant. This is because it has been lingering on for a\n *            significant amount of time since its original context.\n * - display: A tag given to a feed item which signifies that it is still\n *            \"fresh.\" It is within a reasonable amount of time since its\n *            original context.\n */\nconst RENDER_STATUS_HISTORY = 'history',\n      RENDER_STATUS_DISPLAY = 'display',\n      RENDER_STATUS_HIDE = 'hide',\n      DISPLAY_DURATION = 30000,\n      HISTORY_DURATION = 45000;\n\n/*\n * Regenerates the feed. When regenerating the feed, it takes the previous\n * feed, then adds new items and removes stale items. This is exported because\n * other reducers need to re-generate the feed.\n */\nexport const feedGenerate = function(state) {\n\n  const stream = state.stream,\n        [progress, displayThreshold, historyThreshold] = getPositionMilliseconds(stream);\n\n  if(!progress) {\n    return [];\n  }\n\n  const textComments = [...state.textComments],\n        voiceRecordings = [...state.voiceRecordings];\n  let aggregateFeed = [...textComments, ...voiceRecordings];\n\n  aggregateFeed = aggregateFeed.map(el => {\n    const shouldTagHistory = (\n            el.timestampMilliseconds > historyThreshold &&\n            el.timestampMilliseconds <= displayThreshold\n          ),\n          shouldTagDisplay = (\n            el.timestampMilliseconds > displayThreshold &&\n            el.timestampMilliseconds <= progress\n          );\n\n    if(shouldTagHistory) {\n      el.renderStatus = RENDER_STATUS_HISTORY;\n    } else if(shouldTagDisplay) {\n      el.renderStatus = RENDER_STATUS_DISPLAY;\n    } else {\n      el.renderStatus = RENDER_STATUS_HIDE;\n    }\n\n    return { ...el };\n  });\n  aggregateFeed = aggregateFeed.filter(i => (\n    i.renderStatus !== RENDER_STATUS_HIDE\n  ));\n  aggregateFeed = aggregateFeed.sort((a, b) => {\n    return a.timestampMilliseconds - b.timestampMilliseconds;\n  });\n  return aggregateFeed;\n}\n\n\n/*\n * Helper method which gets the timestamp marker thresholds to help define\n * which comments should be displayed.\n */\nconst getPositionMilliseconds = function(stream) {\n\n  if(!stream?.nowPlaying?.track) {\n    return [undefined, undefined, undefined];\n  }\n\n  const startedAt = stream.startedAt;\n\n  let progress = (\n        stream.isPlaying ? Date.now() - startedAt : stream.pausedAt - startedAt\n      ),\n      playbackIntervalIdx = 0,\n      displayThreshold = 0,\n      historyThreshold = 0,\n      cumulativeProgress = 0;\n\n  while(true) {\n    const playbackInterval = stream.nowPlaying.playbackIntervals[playbackIntervalIdx],\n          playbackIntervalDuration = playbackInterval.endPosition - playbackInterval.startPosition;\n    let remainingProgress;\n\n    // if display threshold progress definition has been reached\n    const displayProgress = (progress - DISPLAY_DURATION);\n    remainingProgress = displayProgress - cumulativeProgress;\n    if(remainingProgress >= 0 && remainingProgress < playbackIntervalDuration) {\n      displayThreshold = playbackInterval.startPosition + remainingProgress;\n    }\n\n    // if history threshold progress definition has been reached\n    const historyProgress = (progress - DISPLAY_DURATION - HISTORY_DURATION);\n    remainingProgress = historyProgress - cumulativeProgress;\n    if(remainingProgress >= 0 && remainingProgress < playbackIntervalDuration) {\n      historyThreshold = playbackInterval.startPosition + remainingProgress;\n    }\n\n    // if the progress definition has been reached\n    remainingProgress = progress - cumulativeProgress;\n    if(remainingProgress < playbackIntervalDuration) {\n      progress = playbackInterval.startPosition + remainingProgress;\n      break;\n    }\n\n    playbackIntervalIdx += 1;\n    cumulativeProgress += playbackIntervalDuration;\n  }\n\n  return [progress, displayThreshold, historyThreshold];\n}\n\n\n/*\n * Generates the feed.\n */\nexport const feedUpdate = function(state) {\n  return {\n    ...state,\n    feed: feedGenerate(state),\n  }\n}\n","/*\n * Create a marker relevant to a queue item (track).\n */\nexport const markerCreate = function(state, action) {\n  const trackMarkerMap = { ...state.trackMarkerMap },\n        queueUuid = action.queueUuid,\n        marker = action.marker,\n        markers = [...trackMarkerMap[queueUuid], marker],\n        sortedMarkers = markers.sort((a, b) => {\n          return a.timestampMilliseconds - b.timestampMilliseconds;\n        });\n  trackMarkerMap[queueUuid] = sortedMarkers;\n  return {\n    ...state,\n    trackMarkerMap: trackMarkerMap,\n  };\n}\n\n\n/*\n * Delete a marker relevant to a queue item (track).\n */\nexport const markerDelete = function(state, action) {\n  const trackMarkerMap = { ...state.trackMarkerMap },\n        queueUuid = action.queueUuid,\n        marker = action.marker,\n        markers = trackMarkerMap[action.queueUuid],\n        filteredMarkers = markers.filter(m => m.uuid !== marker.uuid);\n  trackMarkerMap[queueUuid] = filteredMarkers;\n  return {\n    ...state,\n    trackMarkerMap: trackMarkerMap,\n  };\n}\n\n\n/*\n * Set the markers on a queue item (track).\n */\nexport const markerList = function(state, action) {\n  const queueUuid = action.queueUuid,\n        markers = action.markers,\n        trackMarkerMap = { ...state.trackMarkerMap };\n  trackMarkerMap[queueUuid] = markers;\n  return {\n    ...state,\n    trackMarkerMap: trackMarkerMap\n  };\n}\n","import { getProgress } from '../PlaybackApp/utils';\n\n\n/*\n * Returns the (track) queue item that was last played.\n */\nexport const getLastUpQueue = function(lastUpQueues) {\n  return lastUpQueues[lastUpQueues.length - 1];\n}\n\n\n/*\n * Returns the (track) queue item that will be played next.\n */\nexport const getNextUpQueue = function(nextUpQueues) {\n  return (\n    nextUpQueues.length ?\n      (nextUpQueues[0].children.length ?\n        nextUpQueues[0].children[0] :\n        nextUpQueues[0]) :\n      undefined\n  );\n}\n\n\n/*\n *\n */\nexport const flattenQueues = function(queues) {\n  if(!queues.length) {\n    return undefined;\n  }\n\n  const flattenedQueues = [];\n  for(let queue of queues) {\n    if(queue.children.length) {\n      for(let child of queue.children) {\n        flattenedQueues.push(child);\n      }\n    } else {\n      flattenedQueues.push(queue);\n    }\n  }\n\n  return flattenedQueues;\n}\n\n\n/*\n * Returns the (track) queue item that will be played next.\n */\nexport const getQueueDuration = function(queues, stream) {\n\n  // Determines the duration of a queue object.\n  const getDuration = function(queue) {\n    let total = 0;\n    if(queue.children.length) {\n      for(let child of queue.children) {\n        total += child.totalDurationMilliseconds;\n      }\n    } else {\n      total += queue.totalDurationMilliseconds;\n    }\n    return total;\n  }\n\n  // Reducer function which reduces an array of queues into total duration.\n  const reducer = function(total, curr) {\n    if(typeof(total) !== 'number') {\n      total = getDuration(total);\n    }\n    total += getDuration(curr);\n    return total;\n  };\n\n  // In addition to whatever is queued up, we must add the remaining progress\n  // of whatever is now playing in the stream.\n  const progress = getProgress(stream);\n  let remainingProgress = 0;\n  if(progress) {\n    remainingProgress = stream.nowPlaying.totalDurationMilliseconds - progress;\n  }\n\n  // Now add determine the total length of all queue objects.\n  // NOTE: Reduce works differently in JavaScript than in Python! Someone\n  //       explain this madness to me!! 0x213F\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce\n  if(!queues.length) {\n    return remainingProgress + 0;\n  } else if (queues.length === 1) {\n    return remainingProgress + getDuration(queues[0]);\n  } else {\n    return remainingProgress + queues.reduce(reducer);\n  }\n}\n","import { SERVICE_APPLE_MUSIC } from './../../config/services';\n\n/*\n * A queue object is returned from the server with an assortment of\n * intervals. These intervals must be interpreted on the front-end\n * to put together the full picture - how long is the queue item\n * expected to play for?\n */\nexport const finalizeQueue = function(queue) {\n  const copy = { ...queue };\n\n  // Recursive case: parent node (queue item of format collection)\n  if(copy.children.length) {\n    const editedChildren = copy.children.map(finalizeQueue),\n          totalDurationMilliseconds = editedChildren.reduce((total, q) => (\n            total + q.durationMilliseconds\n          ), 0);\n    copy.children = editedChildren;\n    copy.totalDurationMilliseconds = totalDurationMilliseconds;\n    return copy;\n  }\n\n  if(copy.track?.service === SERVICE_APPLE_MUSIC) {\n    copy.track.imageUrl = copy.track.imageUrl.replace(\"{w}\", \"300\");\n    copy.track.imageUrl = copy.track.imageUrl.replace(\"{h}\", \"300\");\n  }\n\n  const intervals = copy.intervals,\n        trackDurationMilliseconds = copy.track?.durationMilliseconds;\n  if(!intervals.length) {\n    copy.totalDurationMilliseconds = trackDurationMilliseconds;\n    copy.playbackIntervals = [\n      {\n        startPosition: 0,\n        endPosition: trackDurationMilliseconds,\n        purpose: \"all\",\n      }\n    ];\n    return copy;\n  }\n\n  const playbackIntervals = [];\n  let lowerBound,\n      upperBound;\n  for(const interval of intervals) {\n\n    // muted\n    if(interval.purpose === 'muted') {\n      if(!interval.lowerBound) {\n        lowerBound = interval.upperBound.timestampMilliseconds;\n      } else if(!interval.upperBound) {\n        if(!lowerBound) {\n          lowerBound = 0;\n        }\n        upperBound = interval.lowerBound.timestampMilliseconds;\n        playbackIntervals.push(\n          {\n            startPosition: lowerBound,\n            endPosition: upperBound,\n            purpose: \"all\",\n          }\n        );\n        // Setting this value signifies that the playbackIntervals array is\n        // finished.\n        lowerBound = undefined;\n      } else {\n        if(!lowerBound) {\n          lowerBound = 0;\n        }\n        upperBound = interval.lowerBound.timestampMilliseconds;\n        playbackIntervals.push(\n          {\n            startPosition: lowerBound,\n            endPosition: upperBound,\n            purpose: \"all\",\n          }\n        );\n        lowerBound = interval.upperBound.timestampMilliseconds;\n        upperBound = undefined;\n      }\n      continue;\n    }\n\n    // stem seperation\n    if(!interval.lowerBound) {\n      const endPosition = (\n        interval.upperBound.timestampMilliseconds ||\n        copy.totalDurationMilliseconds\n      );\n      playbackIntervals.push(\n        {\n          startPosition: 0,\n          endPosition: endPosition,\n          purpose: interval.purpose,\n        }\n      );\n      lowerBound = interval.upperBound.timestampMilliseconds;\n    } else if(!interval.upperBound) {\n      playbackIntervals.push(\n        {\n          startPosition: interval.lowerBound.timestampMilliseconds,\n          endPosition: copy.totalDurationMilliseconds,\n          purpose: interval.purpose,\n        }\n      );\n    } else {\n      playbackIntervals.push(\n        {\n          startPosition: interval.lowerBound.timestampMilliseconds,\n          endPosition: interval.upperBound.timestampMilliseconds,\n          purpose: interval.purpose,\n        }\n      );\n      lowerBound = interval.upperBound.timestampMilliseconds;\n    }\n  }\n\n  if(lowerBound) {\n    upperBound = trackDurationMilliseconds;\n    playbackIntervals.push(\n      {\n        startPosition: lowerBound,\n        endPosition: upperBound,\n        purpose: \"all\",\n        audioUuid: copy.track?.uuid,\n      }\n    );\n  }\n\n  const totalDurationMilliseconds = playbackIntervals.reduce((total, i) => (\n    total + (i.endPosition - i.startPosition)\n  ), 0);\n\n  copy.totalDurationMilliseconds = totalDurationMilliseconds;\n  copy.playbackIntervals = playbackIntervals;\n\n  return copy;\n}\n\n\n/*\n * A queue object is returned from the server with an assortment of\n * intervals. These intervals must be interpreted on the front-end\n * to put together the full picture - how long is the queue item\n * expected to play for?\n */\nexport const queueListSet = function(state, payload) {\n  const lastUpQueues = payload.lastUpQueues.map(finalizeQueue),\n        nextUpQueues = payload.nextUpQueues.map(finalizeQueue),\n        _lastPlayed = state._lastPlayed;\n\n  if(_lastPlayed) {\n    lastUpQueues.push(_lastPlayed);\n  }\n\n  let stream = state.stream;\n  if(!stream.isPlaying && !stream.isPaused && stream.nowPlaying) {\n    lastUpQueues.push(stream.nowPlaying);\n    stream = { ...stream, nowPlaying: undefined }\n  }\n\n  const lastUp = (\n          !lastUpQueues.length ?\n            undefined :\n            lastUpQueues[lastUpQueues.length - 1]\n        ),\n        nextUp = (\n          !nextUpQueues.length ? undefined : (\n            !nextUpQueues[0].children.length ?\n              nextUpQueues[0] :\n              nextUpQueues[0].children[0]\n          )\n        );\n\n  return {\n    ...state,\n    stream: stream,\n    lastUp: lastUp,\n    lastUpQueues: lastUpQueues,\n    nextUp: nextUp,\n    nextUpQueues: nextUpQueues,\n  }\n}\n\n\nexport const queueDeleteNode = function(state, action) {\n  const queues = state.nextUpQueues,\n        filteredQueues = queues.filter(i => i.uuid !== action.queueUuid);\n\n  return {\n    ...state,\n    nextUpQueues: filteredQueues,\n  }\n}\n\n\nexport const queueDeleteChildNode = function(state, action) {\n  let queues = [...state.nextUpQueues];\n  const parentIndex = queues.findIndex(i => i.uuid === action.parentUuid),\n        children = queues[parentIndex].children,\n        filteredChildren = children.filter(i => i.uuid !== action.queueUuid);\n\n  queues[parentIndex].children = filteredChildren;\n\n  if(!filteredChildren.length) {\n    queues = queues.filter(i => i.uuid !== action.parentUuid);\n  }\n\n  return {\n    ...state,\n    nextUpQueues: queues,\n  }\n}\n"," import { finalizeQueue } from './queue';\n\n\n/*\n * ...\n */\nexport const streamSet = function(state, payload) {\n  const stream = payload.stream,\n        nowPlaying = stream.nowPlaying,\n        obj = { ...state };\n\n  if(nowPlaying) {\n    stream.nowPlaying = finalizeQueue(nowPlaying);\n  }\n\n  obj.stream = stream;\n\n  if(!stream.isPlaying && !stream.isPaused && stream.nowPlaying) {\n    obj.lastUp = stream.nowPlaying;\n    obj._lastPlayed = stream.nowPlaying;\n    obj.stream.nowPlaying = undefined;\n    obj.stream.isPlaying = false;\n    obj.stream.isPaused = false;\n  } else if(stream.isPlaying) {\n    const progress = Date.now() - stream.startedAt;\n    if(progress && progress >= stream.nowPlaying.totalDurationMilliseconds) {\n      obj.lastUp = stream.nowPlaying;\n      obj._lastPlayed = stream.nowPlaying;\n      obj.stream.nowPlaying = undefined;\n      obj.stream.isPlaying = false;\n      obj.stream.isPaused = false;\n    }\n  }\n\n  return obj;\n}\n\n\n/*\n * ...\n */\nexport const streamPlay = function(state, payload) {\n  const updatedPayload = {\n    stream: {\n      ...state.stream,\n      isPlaying: true,\n      isPaused: false,\n      startedAt: payload.startedAt,\n    }\n  };\n  return streamSet(state, updatedPayload);\n}\n\n\n/*\n * ...\n */\nexport const streamPause = function(state, payload) {\n  const updatedPayload = {\n    stream: {\n      ...state.stream,\n      isPlaying: false,\n      isPaused: true,\n      pausedAt: payload.pausedAt,\n    }\n  };\n  return streamSet(state, updatedPayload);\n}\n\n\n/*\n * Set the stream context.\n */\nexport const streamPrevTrack = function(state, payload) {\n  const lastUpQueues = [...state.lastUpQueues],\n        nextUpQueues = [...state.nextUpQueues],\n        lastNowPlaying = state.stream.nowPlaying,\n        nextUpQueue = nextUpQueues[0],\n        nextNowPlaying = lastUpQueues[lastUpQueues.length - 1];\n\n  const isTrackInCollection = (\n    lastNowPlaying?.parentUuid &&\n    nextUpQueue?.uuid &&\n    lastNowPlaying?.parentUuid === nextUpQueue?.uuid\n  );\n  if(lastNowPlaying) {\n    if(isTrackInCollection) {\n      nextUpQueue.children.unshift(lastNowPlaying);\n    } else {\n      nextUpQueues.unshift(lastNowPlaying);\n    }\n  }\n\n  lastUpQueues.pop();\n\n  return {\n      ...state,\n      stream: {\n        ...state.stream,\n        startedAt: payload.startedAt,\n        nowPlaying: nextNowPlaying,\n        isPlaying: true,\n        isPaused: false,\n      },\n      lastUpQueues: lastUpQueues,\n      nextUpQueues: nextUpQueues,\n      _lastPlayed: undefined,\n  };\n}\n\n\n/*\n * ...\n */\nexport const streamNextTrack = function(state, payload) {\n  const lastUpQueues = [...state.lastUpQueues],\n        nextUpQueues = [...state.nextUpQueues],\n        lastNowPlaying = state.stream.nowPlaying,\n        nextUpQueue = nextUpQueues[0],\n        nextNowPlaying = (\n          nextUpQueue ?\n            (nextUpQueue.children.length ?\n              nextUpQueue.children[0] :\n              nextUpQueue) :\n            undefined\n        );\n\n  if(lastNowPlaying) {\n    lastUpQueues.push(lastNowPlaying);\n  }\n\n  if(nextUpQueue) {\n    if(nextUpQueue.children.length) {\n      nextUpQueue.children.shift();\n      if(!nextUpQueue.children.length) {\n        nextUpQueues.shift();\n      }\n    } else {\n      nextUpQueues.shift();\n    }\n  }\n\n  return {\n      ...state,\n      stream: {\n        ...state.stream,\n        startedAt: payload.startedAt,\n        nowPlaying: nextNowPlaying,\n        isPlaying: !!nextNowPlaying,\n        isPaused: false,\n      },\n      lastUpQueues: lastUpQueues,\n      nextUpQueues: nextUpQueues,\n      _lastPlayed: lastNowPlaying,\n  };\n}\n","import {\n  SERVICE_APPLE_MUSIC,\n  SERVICE_SPOTIFY,\n} from '../../config/services';\nimport { getNextUpQueue } from '../../components/QueueApp/utils';\nimport { cycleVolumeLevel } from '../../components/PlaybackApp/utils';\nimport { streamNextTrack } from './stream';\n\n\nexport const playbackAppleMusic = function(state, payload) {\n  return {\n    ...state,\n    playback: {\n      ...state.playback,\n      appleMusic: {\n        api: payload.appleMusicApi,\n      },\n      isReady: true,\n    }\n  }\n}\n\n\n/*\n *\n */\nexport const playbackSpotify = function(state, payload) {\n  return {\n    ...state,\n    playback: {\n      ...state.playback,\n      spotifyApi: payload.spotifyApi,\n      isReady: true,\n    }\n  }\n}\n\n\nexport const playbackYouTube = function(state, payload) {\n  return {\n    ...state,\n    playback: {\n      ...state.playback,\n      youTubeApi: payload.youTubeApi,\n      // TODO refactor ready flags\n    }\n  }\n}\n\n\n/*\n * Assumptions:\n *   - There is currently something playing in the stream.\n *   - We are not certain that something is up next.\n */\nexport const playbackAddToQueue = function(state) {\n  const nextUp = getNextUpQueue(state.nextUpQueues);\n  if(!nextUp) {\n    return { ...state };\n  }\n\n  const playback = { ...state.playback },\n        nowPlaying = state.stream.nowPlaying,\n        appleMusicShouldAddToQueue = (\n          nowPlaying.track.service === SERVICE_APPLE_MUSIC &&\n          nextUp.track.service === SERVICE_APPLE_MUSIC &&\n          nextUp.playbackIntervals[0].startPosition === 0\n        ),\n        spotifyShouldAddToQueue = (\n          nowPlaying.track.service === SERVICE_SPOTIFY &&\n          nextUp.track.service === SERVICE_SPOTIFY &&\n          nextUp.playbackIntervals[0].startPosition === 0\n        );\n\n  if(appleMusicShouldAddToQueue) {\n    playback.queuedUp = true;\n\n    const playbackIntervals = nowPlaying.playbackIntervals,\n          lastInterval = (\n            playbackIntervals[playbackIntervals.length - 1]\n          );\n    if(lastInterval.endPosition === nowPlaying.track.durationMilliseconds) {\n      playback.noopNextTrack = true;\n    }\n  }\n\n  if(spotifyShouldAddToQueue) {\n    playback.queuedUp = true;\n\n    const playbackIntervals = nowPlaying.playbackIntervals,\n          lastInterval = (\n            playbackIntervals[playbackIntervals.length - 1]\n          );\n    if(lastInterval.endPosition === nowPlaying.track.durationMilliseconds) {\n      playback.noopNextTrack = true;\n    }\n  }\n\n  return {\n    ...state,\n    playback: playback,\n  }\n}\n\n\n/*\n *\n */\nconst playbackPlannedNextTrackHelper = function(state) {\n  const nextUp = getNextUpQueue(state.nextUpQueues),\n        queuedUp = state.playback.queuedUp,\n        noopNextTrack = state.playback.noopNextTrack,\n        addToQueueTimeoutId = state.playback.addToQueueTimeoutId,\n        nextSeekTimeoutId = state.playback.nextSeekTimeoutId,\n        playback = {\n          ...state.playback,\n          queuedUp: false,\n          noopNextTrack: false,\n        };\n  if(!nextUp || noopNextTrack) {\n    playback.addToQueueTimeoutId = undefined;\n    return {\n      ...state,\n      playback: playback,\n    };\n  }\n\n  if(queuedUp) {\n    playback.addToQueueTimeoutId = undefined;\n    return {\n      ...state,\n      playback: playback,\n    };\n  }\n\n  clearTimeout(addToQueueTimeoutId);\n  clearTimeout(nextSeekTimeoutId);\n  playback.isPlaying = false;\n  playback.addToQueueTimeoutId = undefined;\n  playback.nextSeekTimeoutId = undefined;\n  return {\n    ...state,\n    playback: playback,\n  };\n}\n\n\n/*\n *\n */\nexport const playbackPlannedNextTrack = function(state, payload) {\n  let updatedState = state;\n  updatedState = playbackPlannedNextTrackHelper(updatedState);\n  const childPayload = payload.payload,  // yes\n        updatedNowPlaying = updatedState.stream.nowPlaying;\n  childPayload.startedAt = (\n    updatedState.stream.startedAt + updatedNowPlaying.totalDurationMilliseconds\n  );\n  updatedState = streamNextTrack(updatedState, childPayload);\n  return updatedState;\n}\n\n\n/*\n *\n */\nexport const playbackStart = function(state) {\n  const addToQueueTimeoutId = state.playback.addToQueueTimeoutId,\n        nextSeekTimeoutId = state.playback.nextSeekTimeoutId,\n        playback = {\n          ...state.playback,\n          queuedUp: false,\n          noopNextTrack: false,\n          isPlaying: false,\n          addToQueueTimeoutId: undefined,\n        };\n\n  clearTimeout(addToQueueTimeoutId);\n  clearTimeout(nextSeekTimeoutId);\n\n  return {\n    ...state,\n    playback: playback,\n  };\n}\n\n\n/*\n *\n */\nexport const playbackStarted = function(state) {\n  const playback = {\n          ...state.playback,\n          isPlaying: true,\n        };\n  return {\n    ...state,\n    playback: playback,\n  };\n}\n\n\nexport const playbackAddToQueueReschedule = function(state) {\n  const addToQueueTimeoutId = state.playback.addToQueueTimeoutId,\n        nextSeekTimeoutId = state.playback.nextSeekTimeoutId,\n        playback = {\n          ...state.playback,\n          addToQueueTimeoutId: undefined,\n          nextSeekTimeoutId: undefined,\n        };\n\n  clearTimeout(addToQueueTimeoutId);\n  clearTimeout(nextSeekTimeoutId);\n\n  return {\n    ...state,\n    playback: playback,\n  };\n}\n\n\nexport const playbackAddToQueueScheduled = function(state, payload) {\n  const playback = {\n          ...state.playback,\n          addToQueueTimeoutId: payload.addToQueueTimeoutId,\n        };\n  return {\n    ...state,\n    playback: playback,\n  };\n}\n\n\nexport const playbackNextSeekScheduled = function(state, payload) {\n  const nextSeekTimeoutId = state.playback.nextSeekTimeoutId,\n        playback = {\n          ...state.playback,\n          nextSeekTimeoutId: payload.nextSeekTimeoutId,\n        };\n\n  clearTimeout(nextSeekTimeoutId);\n\n  return {\n    ...state,\n    playback: playback,\n  };\n}\n\n\nexport const playbackDisable = function(state) {\n  return {\n    ...state,\n    playback: {\n      ...state.playback,\n      controlsEnabled: false,\n    }\n  }\n}\n\n\nexport const playbackEnable = function(state) {\n  return {\n    ...state,\n    playback: {\n      ...state.playback,\n      controlsEnabled: true,\n    }\n  }\n}\n\n\nexport const playbackLoadFiles = function(state, payload) {\n  const playback = { ...state.playback },\n        files = { ...state.playback.files };\n\n  const audiosObj = { all: new Audio(payload.track.audioUrl) };\n\n  for(const stem of payload.track.stems) {\n    audiosObj[stem.instrument] = new Audio(stem.audioUrl);\n  }\n\n  files[payload.track.uuid] = audiosObj;\n  return {\n    ...state,\n    playback: {\n      ...playback,\n      files: files,\n    }\n  };\n}\n\n\nexport const playbackCycleVolumeLevelAudio = function(state) {\n  const volumeLevel = { ...state.playback.volumeLevel },\n        audioLevel = volumeLevel.audio;\n\n  volumeLevel.audio = cycleVolumeLevel(audioLevel);\n\n  return {\n    ...state,\n    playback: { ...state.playback, volumeLevel },\n  }\n}\n"," import { finalizeQueue } from './queue';\n\n\n/*\n * Used to \"findIndex\" by uuid in an array.\n */\nconst findByUuid = function(uuid) {\n  return (o => o.uuid === uuid);\n}\n\n\n/*\n * Used to \"filter\" out by uuid in an array.\n */\nconst filterByUuid = function(uuid) {\n  return (o => o.uuid !== uuid);\n}\n\n\n/*\n * Used to \"sort\" and array containing queue intervals.\n */\nconst sortQueueIntervals = function(a, b) {\n  if(!b.upperBound) {\n    return -1;\n  } else if(!a.upperBound) {\n    return 1;\n  } else {\n    return (\n      a.upperBound.timestampMilliseconds -\n      a.upperBound.timestampMilliseconds\n    );\n  }\n}\n\n\n/*\n * Create a queue interval relevant to a queue item (track).\n */\nexport const queueIntervalCreate = function(state, action) {\n  const queueInterval = action.queueInterval,\n        queueUuid = action.queueUuid,\n        parentQueueUuid = action.parentQueueUuid;\n\n  // get the queue that the queue interval belongs too.\n  let queues = state.nextUpQueues;\n  let parentIndex = -1, index;\n  if(parentQueueUuid) {\n    parentIndex = queues.findIndex(findByUuid(parentQueueUuid));\n    queues = queues[parentIndex].children;\n  }\n  index = queues.findIndex(findByUuid(queueUuid));\n  const trackQueue = queues[index];\n\n  // add queue interval to that queue (and sort).\n  const queueIntervals = [...trackQueue.intervals, queueInterval],\n        sortedQueueIntervals = queueIntervals.sort(sortQueueIntervals);\n\n  // save the state\n  const nextUpQueues = [...state.nextUpQueues];\n  if(parentIndex !== -1) {\n    nextUpQueues[parentIndex].children[index].intervals = sortedQueueIntervals;\n  } else {\n    nextUpQueues[index].intervals = sortedQueueIntervals;\n  }\n\n  // update playback intervals\n  const finalizedNextUpQueues = nextUpQueues.map(finalizeQueue);\n\n  return {\n    ...state,\n    nextUpQueues: finalizedNextUpQueues,\n  };\n}\n\n\n/*\n * Delete a queue interval relevant to a queue item (track).\n */\nexport const queueIntervalDelete = function(state, action) {\n  const queueInterval = action.queueInterval,\n        queueUuid = action.queueUuid,\n        parentQueueUuid = action.parentQueueUuid;\n\n  // get the queue that the queue interval belongs too.\n  let queues = state.nextUpQueues;\n  let parentIndex = -1, index;\n  if(parentQueueUuid) {\n    parentIndex = queues.findIndex(findByUuid(parentQueueUuid));\n    queues = queues[parentIndex].children;\n  }\n  index = queues.findIndex(findByUuid(queueUuid));\n  const trackQueue = queues[index];\n\n  // delete queue interval from that queue.\n  const queueIntervals = [...trackQueue.intervals],\n        filteredQueueIntervals = queueIntervals.filter(filterByUuid(queueInterval.uuid));\n\n  // save the state\n  const nextUpQueues = [...state.nextUpQueues];\n  if(parentIndex !== -1) {\n    nextUpQueues[parentIndex].children[index].intervals = filteredQueueIntervals;\n  } else {\n    nextUpQueues[index].intervals = filteredQueueIntervals;\n  }\n\n  // update playback intervals\n  const finalizedNextUpQueues = nextUpQueues.map(finalizeQueue);\n\n  return {\n   ...state,\n   nextUpQueues: finalizedNextUpQueues,\n  };\n}\n","import { feedGenerate } from './feed';\n\n\n/*\n * ...\n */\nexport const textCommentListSet = function(state, payload) {\n  const textComments = payload.textComments,\n        updatedState = {\n          ...state,\n          textComments: textComments,\n        };\n\n  return {\n    ...updatedState,\n    feed: feedGenerate(updatedState),\n  };\n}\n\n\n/*\n *\n */\nexport const textCommentCreate = function(state, payload) {\n  const textComments = [...state.textComments, payload.textComment],\n        updatedState = {\n          ...state,\n          textComments: textComments,\n        };\n\n  return {\n    ...updatedState,\n    feed: feedGenerate(updatedState),\n  };\n}\n\n\n/*\n *\n */\nexport const textCommentDelete = function(state, payload) {\n  const deleteByUuid = i => i.uuid !== payload.textCommentUuid,\n        textComments = state.textComments.filter(deleteByUuid),\n        updatedState = {\n          ...state,\n          textComments: textComments,\n        };\n\n  return {\n    ...updatedState,\n    feed: feedGenerate(updatedState),\n  };\n}\n","/*\n * ...\n */\nexport const textCommentModificationCreate = function(state, payload) {\n  const textCommentModifications = payload.textCommentModifications,\n        modifiedModification = textCommentModifications.modified,\n        deletedModifications = textCommentModifications.deleted,\n        textCommentUuid = payload.textCommentUuid,\n        textComments = [...state.textComments],\n        textCommentIndex = textComments.findIndex(t => (\n          t.uuid === textCommentUuid\n        )),\n        textComment = textComments[textCommentIndex];\n\n  let modifications = [...textComment.modifications],\n      existingIdx;\n  existingIdx = modifications.findIndex(t => (\n    t.uuid === modifiedModification.uuid\n  ));\n  if(existingIdx !== -1) {\n    modifications[existingIdx] = modifiedModification;\n  } else {\n    modifications.push(modifiedModification);\n    modifications = modifications.sort((a, b) => {\n      return a.startPtr - b.startPtr;\n    });\n  }\n\n  if(deletedModifications) {\n    for(let idx=0; idx < deletedModifications.length; idx++) {\n      const deletedModification = deletedModifications[idx];\n      existingIdx = modifications.findIndex(t => (\n        t.uuid === deletedModifications.uuid\n      ));\n      if(existingIdx !== -1) {\n        modifications = modifications.filter(i => i.uuid !== deletedModification.uuid);\n      }\n    }\n  }\n\n  textComments[textCommentIndex].modifications = modifications;\n\n  return {\n    ...state,\n    textComments: textComments,\n  }\n}\n\n\n/*\n * ...\n */\nexport const textCommentClearModifications = function(state, payload) {\n  const textCommentIndex = state.textComments.findIndex(t => t.uuid === payload.textCommentUuid),\n        textComments = [...state.textComments];\n\n  textComments[textCommentIndex].modifications = [];\n\n  return {\n    ...state,\n    textComments: textComments,\n  }\n}\n","import { feedGenerate } from './feed';\n\n\n/*\n * ...\n */\nexport const voiceRecordingListSet = function(state, payload) {\n  const voiceRecordings = payload.voiceRecordings,\n        updatedState = {\n          ...state,\n          voiceRecordings: voiceRecordings,\n        };\n\n  return {\n    ...updatedState,\n    feed: feedGenerate(updatedState),\n  };\n}\n\n\n/*\n * ...\n */\nexport const voiceRecordingCreate = function(state, action) {\n  const voiceRecordings = [...state.voiceRecordings, action.voiceRecording],\n        updatedState = {\n          ...state,\n          voiceRecordings: voiceRecordings,\n        };\n\n  return {\n    ...updatedState,\n    feed: feedGenerate(updatedState),\n  };\n}\n\n\n/*\n * ...\n */\nexport const voiceRecordingDelete = function(state, action) {\n  const deleteByUuid = i => i.uuid !== action.voiceRecordingUuid,\n        voiceRecordings = state.voiceRecordings.filter(deleteByUuid),\n        updatedState = {\n          ...state,\n          voiceRecordings: voiceRecordings,\n        };\n\n  return {\n    ...updatedState,\n    feed: feedGenerate(updatedState),\n  };\n}\n","export const userSettingsUpdate = function(state, payload) {\n  return {\n    ...state,\n    userSettings: {\n        ...state.userSettings,\n        ...payload,\n    }\n  }\n}\n\n\nexport const userGetSettings = function(state, action) {\n  return {\n    ...state,\n    userSettings: action.userSettings,\n  }\n}\n","import { createStore } from 'redux';\nimport { feedUpdate } from './reducers/feed';\nimport {\n  markerCreate,\n  markerDelete,\n  markerList,\n} from './reducers/marker';\nimport {\n  playbackAppleMusic,\n  playbackSpotify,\n  playbackYouTube,\n  playbackAddToQueue,\n  playbackPlannedNextTrack,\n  playbackStart,\n  playbackStarted,\n  playbackAddToQueueReschedule,\n  playbackAddToQueueScheduled,\n  playbackNextSeekScheduled,\n  playbackDisable,\n  playbackEnable,\n  playbackLoadFiles,\n  playbackCycleVolumeLevelAudio,\n} from  './reducers/playback';\nimport {\n  queueListSet,\n  queueDeleteNode,\n  queueDeleteChildNode,\n} from './reducers/queue';\nimport {\n  queueIntervalCreate,\n  queueIntervalDelete,\n} from './reducers/queueInterval';\nimport {\n  streamSet,\n  streamPlay,\n  streamPause,\n  streamPrevTrack,\n  streamNextTrack,\n} from './reducers/stream';\nimport {\n  textCommentListSet,\n  textCommentCreate,\n  textCommentDelete,\n} from './reducers/textComment';\nimport {\n  textCommentModificationCreate,\n  textCommentClearModifications,\n} from './reducers/textCommentModification';\nimport {\n  voiceRecordingListSet,\n  voiceRecordingCreate,\n  voiceRecordingDelete,\n} from './reducers/voiceRecording';\nimport {\n  userSettingsUpdate,\n  userGetSettings,\n} from './reducers/userSettings';\n\n\nconst initialState = {\n  nextUpQueues: [],\n  lastUpQueues: [],\n  _lastPlayed: undefined,\n  textComments: [],\n  voiceRecordings: [],\n  feed: [],\n  userSettings: undefined,\n  trackMarkerMap: {},\n  playback: {\n    controlsEnabled: false,\n    spotifyApi: undefined,\n    youTubeApi: undefined,\n    appleMusic: {},\n    isPlaying: false,\n    queuedUp: false,\n    noopNextTrack: false,\n    addToQueueTimeoutId: undefined,\n    isReady: false,\n    files: {},\n    volumeLevel: {\n      audio: 1.00,\n      voice: 1.00,\n    },\n  },\n}\n\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    ////////////////////////////////////////////////////////////////////////////\n    // STREAM\n    case \"stream/set\":\n      return streamSet(state, action.payload);\n    case \"stream/play\":\n      return streamPlay(state, action.payload);\n    case \"stream/pause\":\n      return streamPause(state, action.payload);\n    case \"stream/prevTrack\":\n      return streamPrevTrack(state, action.payload);\n    case \"stream/nextTrack\":\n      return streamNextTrack(state, action.payload);\n    ////////////////////////////////////////////////////////////////////////////\n    // QUEUE\n    case \"queue/listSet\":\n      return queueListSet(state, action.payload);\n    case \"queue/deleteNode\":\n      return queueDeleteNode(state, action);\n    case \"queue/deleteChildNode\":\n      return queueDeleteChildNode(state, action);\n    case \"textComment/listSet\":\n    ////////////////////////////////////////////////////////////////////////////\n    // TEXT COMMENT\n      return textCommentListSet(state, action.payload);\n    case \"textComment/create\":\n      return textCommentCreate(state, action.payload);\n    case \"textComment/delete\":\n      return textCommentDelete(state, action.payload);\n    case \"textCommentModification/create\":\n      return textCommentModificationCreate(state, action.payload);\n    case \"textComment/clearModifications\":\n      return textCommentClearModifications(state, action.payload);\n    ////////////////////////////////////////////////////////////////////////////\n    // VOICE RECORDING\n    case \"voiceRecording/create\":\n      return voiceRecordingCreate(state, action);\n    case \"voiceRecording/listSet\":\n      return voiceRecordingListSet(state, action.payload);\n    case \"voiceRecording/delete\":\n      return voiceRecordingDelete(state, action);\n    ////////////////////////////////////////////////////////////////////////////\n    // FEED\n    case \"feed/update\":\n      return feedUpdate(state);\n    ////////////////////////////////////////////////////////////////////////////\n    // USER\n    case \"user/get-settings\":\n      return userGetSettings(state, action);\n    case \"userSettings/update\":\n      return userSettingsUpdate(state, action.payload);\n    ////////////////////////////////////////////////////////////////////////////\n    // MARKER\n    case \"marker/create\":\n      return markerCreate(state, action.payload);\n    case \"marker/delete\":\n      return markerDelete(state, action.payload);\n    case \"marker/list\":\n      return markerList(state, action.payload);\n    ////////////////////////////////////////////////////////////////////////////\n    // QUEUE INTERVAL\n    case \"queueInterval/create\":\n      return queueIntervalCreate(state, action.payload);\n    case \"queueInterval/delete\":\n      return queueIntervalDelete(state, action.payload);\n    ////////////////////////////////////////////////////////////////////////////\n    // PLAYBACK\n    case \"playback/disable\":\n      return playbackDisable(state);\n    case \"playback/enable\":\n      return playbackEnable(state);\n    case \"playback/appleMusic\":\n      return playbackAppleMusic(state, action.payload);\n    case \"playback/spotify\":\n      return playbackSpotify(state, action.payload);\n    case \"playback/youTube\":\n      return playbackYouTube(state, action.payload);\n    case \"playback/addToQueue\":\n      return playbackAddToQueue(state);\n    case \"playback/plannedNextTrack\":\n      return playbackPlannedNextTrack(state, action.payload);\n    case \"playback/start\":\n      return playbackStart(state);\n    case \"playback/started\":\n      return playbackStarted(state);\n    case \"playback/addToQueueReschedule\":\n      return playbackAddToQueueReschedule(state);\n    case \"playback/addToQueueScheduled\":\n      return playbackAddToQueueScheduled(state, action.payload);\n    case \"playback/nextSeekScheduled\":\n      return playbackNextSeekScheduled(state, action.payload);\n    case \"playback/loadFiles\":\n      return playbackLoadFiles(state, action.payload);\n    case \"playback/cycleVolumeLevelAudio\":\n      return playbackCycleVolumeLevelAudio(state);\n    // case \"@redux/INIT\":\n    //   return state;\n    default:\n      return state;\n      // throw new Error(`Unregistered Redux event: ${action.type}`);\n  }\n}\n\n\nexport const store = createStore(reducer, window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__({ trace: true }));\n","import { getPositionMilliseconds } from './utils';\n\nimport {\n  SERVICE_APPLE_MUSIC,\n  SERVICE_SPOTIFY,\n  SERVICE_YOUTUBE,\n  SERVICE_JUKEBOX_RADIO,\n} from '../../config/services';\nimport {\n  fetchTrackGetFiles,\n} from './Player/network';\nimport { store } from '../../utils/redux';\n\n\n/*\n * Executes the \"start\" of playback given:\n *     - playback (singleton instance in the React application)\n *     - stream\n */\nexport const playbackControlStart = function(playback, stream) {\n  const arr = getPositionMilliseconds(stream, stream.startedAt),\n        positionMilliseconds = arr[0],\n        instrument = arr[2],\n        playbackService = stream.nowPlaying.track.service;\n  if(playbackService === SERVICE_APPLE_MUSIC) {\n    const music = window.MusicKit.getInstance();\n    music.setQueue({ song: stream.nowPlaying.track.externalId })\n      .then(() => {\n        music.player.play()\n          .then(() => {\n            music.player.pause()\n              .then(() => {\n                const delayArr = getPositionMilliseconds(stream, stream.startedAt),\n                      delayPositionMilliseconds = delayArr[0];\n                music.player.seekToTime(delayPositionMilliseconds / 1000)\n                  .then(() => {\n                    music.player.play();\n                  });\n              });\n          });\n      });\n  } else if(playbackService === SERVICE_SPOTIFY) {\n    playback.spotifyApi.play({\n      uris: [stream.nowPlaying.track.externalId],\n      position_ms: positionMilliseconds,\n    });\n  } else if(playbackService === SERVICE_YOUTUBE) {\n    playback.youTubeApi.seekTo(positionMilliseconds / 1000);\n    playback.youTubeApi.playVideo();\n  } else if(playbackService === SERVICE_JUKEBOX_RADIO) {\n    const trackUuid = stream.nowPlaying.track.uuid,\n          audio = playback.files[trackUuid][instrument];\n    if(positionMilliseconds > 0) {\n      audio.currentTime = positionMilliseconds / 1000;\n    }\n    audio.play();\n  }\n};\n\n\n/*\n * \"Pauses\" the current playback given:\n *     - playback (singleton instance in the React application)\n *     - stream\n */\nexport const playbackControlPause = function(playback, stream) {\n  const playbackService = stream.nowPlaying.track.service;\n\n  if(playbackService === SERVICE_APPLE_MUSIC) {\n    const music = window.MusicKit.getInstance();\n    music.player.pause();\n  } else if(playbackService === SERVICE_SPOTIFY) {\n    playback.spotifyApi.pause();\n  } else if(playbackService === SERVICE_YOUTUBE) {\n    playback.youTubeApi.pauseVideo();\n  } else if(playbackService === SERVICE_JUKEBOX_RADIO) {\n    const trackUuid = stream.nowPlaying.track.uuid,\n          audios = playback.files[trackUuid];\n    // eslint-disable-next-line\n    for(const [instrument, audio] of Object.entries(audios)) {\n      if(audio.paused) {\n        audio.pause();\n      }\n    }\n  }\n}\n\n\n/*\n * \"Plays\" the current playback given:\n *     - playback (singleton instance in the React application)\n *     - stream\n */\nexport const playbackControlPlay = function(playback, stream) {\n  const playbackService = stream.nowPlaying.track.service;\n\n  if(playbackService === SERVICE_APPLE_MUSIC) {\n    const music = window.MusicKit.getInstance();\n    music.player.play();\n  } else if(playbackService === SERVICE_SPOTIFY) {\n    playback.spotifyApi.play();\n  } else if(playbackService === SERVICE_YOUTUBE) {\n    playback.youTubeApi.playVideo();\n  } else if(playbackService === SERVICE_JUKEBOX_RADIO) {\n    const arr = getPositionMilliseconds(stream, stream.startedAt),\n          instrument = arr[2],\n          trackUuid = stream.nowPlaying.track.uuid,\n          audio = playback.files[trackUuid][instrument];\n    audio.play();\n  }\n}\n\n\n/*\n * \"Seeks\" the current playback given to the expected position given:\n *     - playback (singleton instance in the React application)\n *     - stream\n */\nexport const playbackControlSeek = function(playback, stream, startedAt) {\n  const arr = getPositionMilliseconds(stream, startedAt),\n        positionMilliseconds = arr[0],\n        instrument = arr[2],\n        playbackService = stream.nowPlaying.track.service;\n\n  if(playbackService === SERVICE_APPLE_MUSIC) {\n    const music = window.MusicKit.getInstance();\n    music.player.seekToTime(positionMilliseconds / 1000);\n  } else if(playbackService === SERVICE_SPOTIFY) {\n    playback.spotifyApi.seek(positionMilliseconds);\n  } else if(playbackService === SERVICE_YOUTUBE) {\n    playback.youTubeApi.seekTo(positionMilliseconds / 1000);\n    playback.youTubeApi.playVideo();\n  } else if(playbackService === SERVICE_JUKEBOX_RADIO) {\n    const trackUuid = stream.nowPlaying.track.uuid,\n          audios = playback.files[trackUuid],\n          audio = audios[instrument];\n\n    // Pause everything else so only the new stem is played\n    for(const [instr, aud] of Object.entries(audios)) {\n      if(instr === instrument) {\n        continue;\n      }\n      if(!aud.paused) {\n        aud.pause();\n      }\n    }\n\n    audio.currentTime = positionMilliseconds / 1000;\n    audio.play();\n  }\n}\n\n\n/*\n *\n */\nexport const playbackControlSkipToNext = function(playback, stream) {\n  const playbackService = stream.nowPlaying.track.service;\n\n  if(playbackService === SERVICE_APPLE_MUSIC) {\n    const music = window.MusicKit.getInstance();\n    music.player.skipToNextItem();\n  } else if(playbackService === SERVICE_SPOTIFY) {\n    playback.spotifyApi.skipToNext();\n  } else if(playbackService === SERVICE_YOUTUBE) {\n    // TODO - seems to work out of the box :)\n  } else if(playbackService === SERVICE_JUKEBOX_RADIO) {\n    // TODO - refactor stuff to go inside of here instead\n  }\n}\n\n\n/*\n * \"Queues\" the (track) queue item up next given:\n *     - playback (singleton instance in the React application)\n *     - stream\n *     - nextUp\n *\n * In this context, queuing up the track means doing as much pre-loading as\n * possible.\n */\nexport const playbackControlQueue = function(playback, stream, nextUp) {\n  if(!nextUp) {\n    return;\n  }\n\n  const nowPlaying = stream.nowPlaying,\n        playbackService = nowPlaying.track.service,\n        nextPlaybackService = nextUp.track.service;\n  let shouldAddToQueue;\n\n  // Apple Music\n  shouldAddToQueue = nextPlaybackService === SERVICE_APPLE_MUSIC;\n  if(shouldAddToQueue) {\n    const music = window.MusicKit.getInstance();\n    music.player.prepareToPlay(nextUp.track.externalId);\n\n    const canPlayNext = (\n      playbackService === SERVICE_APPLE_MUSIC &&\n      nextUp.playbackIntervals[0].startPosition === 0\n    );\n    if(canPlayNext) {\n      music.playNext({ song: nextUp.track.externalId });\n    }\n  }\n\n  // Spotify\n  shouldAddToQueue = (\n    playbackService === SERVICE_SPOTIFY &&\n    nextPlaybackService === SERVICE_SPOTIFY &&\n    nextUp.playbackIntervals[0].startPosition === 0\n  );\n  if(shouldAddToQueue) {\n    playback.spotifyApi.queue(nextUp.track.externalId);\n  }\n\n  // YouTube\n  // TODO\n\n  // Jukebox Radio\n  shouldAddToQueue = nextPlaybackService === SERVICE_JUKEBOX_RADIO;\n  if(shouldAddToQueue) {\n    fetchTrackGetFiles(nextUp.track.uuid)\n      .then((responseJson) => {\n        store.dispatch(responseJson.redux);\n      });\n  }\n}\n\n\nexport const playbackChangeVolume = function(playback, stream, volumeLevel) {\n  const music = window.MusicKit.getInstance();\n  music.player.volume = volumeLevel;\n\n  playback.spotifyApi.setVolume(volumeLevel * 100);\n\n  playback.youTubeApi.setVolume(volumeLevel * 100);\n\n  const trackUuid = stream.nowPlaying?.track?.uuid,\n        audios = playback.files[trackUuid];\n  if(audios) {\n    audios.all.volume = volumeLevel;\n    audios.drums.volume = volumeLevel;\n    audios.vocals.volume = volumeLevel;\n    audios.bass.volume = volumeLevel;\n    audios.other.volume = volumeLevel;\n  }\n}\n","import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport styles from './Login.module.css';\n\nimport { fetchAuthToken, fetchInitializeStream } from './network';\n\n\nfunction Login(props) {\n\n  /*\n   * \n   */\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [rememberMe, setRememberMe] = useState(false);\n\n  /*\n   * When the user initializes a login attempt.\n   */\n  const handleSubmit = async function(e) {\n    e.preventDefault();\n\n    const responseJson = await fetchAuthToken(username, password);\n    if(!responseJson.access || !responseJson.refresh) {\n      return;\n    }\n\n    localStorage.setItem('accessToken', responseJson.access);\n    localStorage.setItem('refreshToken', responseJson.refresh);\n\n    await fetchInitializeStream();\n\n    window.location.href = '/app/search';\n  }\n\n  return (\n    <form className={styles.Login} onSubmit={async (e) => { await handleSubmit(e); }}>\n      <h3>Sign in</h3>\n      <p>Contact a system administrator for login information.</p>\n      <p>At this time, new registrations are on a case by case basis.</p>\n\n      <br></br>\n\n      <label className={styles.FormBlock}>\n        Username&nbsp;&nbsp;\n        <input type=\"text\"\n               name=\"username\"\n               placeholder=\"username\"\n               value={username}\n               onChange={(e) => {setUsername(e.target.value)}} />\n      </label>\n\n      <label className={styles.FormBlock}>\n        Password&nbsp;&nbsp;\n        <input type=\"password\"\n               name=\"password\"\n               placeholder=\"password\"\n               value={password}\n               onChange={(e) => {setPassword(e.target.value)}} />\n      </label>\n\n      <br></br>\n\n      <label className={styles.FormBlock}>\n        <input type=\"checkbox\"\n               name=\"remember-me\"\n               value={rememberMe}\n               onChange={(e) => {setRememberMe(e.target.value)}} />\n        Remember Me\n      </label>\n\n      <br></br>\n\n      <div className={styles.FormBlock}>\n        <button type=\"submit\">\n          Sign In\n        </button>\n        <span>&nbsp;&nbsp;<Link to=\"/forgotpassword\">Forgot Password?</Link></span>\n      </div>\n    </form>\n  );\n}\n\nexport default Login;\n","import {\n  ENDPOINT_USER_GET_SETTINGS,\n  ENDPOINT_USER_UPDATE_SETTINGS,\n} from '../../config/api'\nimport { TYPE_GET, TYPE_POST } from '../../config/global'\nimport { fetchBackend } from '../../utils/network'\n\n/*\n * Fetches an user settings from the server.\n */\nexport const fetchGetUserSettings = async () => {\n  const response = await fetchBackend(\n    TYPE_GET,\n    ENDPOINT_USER_GET_SETTINGS,\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n\n/*\n * Set user settings on the server.\n */\nexport const fetchUpdateUserSettings = async (field, value) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_USER_UPDATE_SETTINGS,\n    { field, value },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","import { ENDPOINT_USER_CONNECT_SPOTIFY } from '../../config/api';\nimport { TYPE_POST } from '../../config/global';\nimport { fetchBackend } from '../../utils/network';\n\n/*\n * Fetches an auth token from the server.\n */\nexport const fetchUserConnectSpotify = async (code, error) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_USER_CONNECT_SPOTIFY,\n    { code, error },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","import React, { useEffect } from \"react\";\n// import styles from './SpotifySync.module.css';\n\nimport { fetchUserConnectSpotify } from './network';\n\n\nfunction SpotifySync(props) {\n\n  useEffect(() => {\n    async function postData() {\n      const queryString = window.location.search,\n            urlParams = new URLSearchParams(queryString),\n            code = urlParams.get('code'),\n            error = urlParams.get('error');\n\n      await fetchUserConnectSpotify(code, error);\n\n      window.location.href = '../app/search'\n    }\n    postData();\n  }, []);\n\n  return (\n    <p>Redirecting...</p>\n  );\n}\n\nexport default SpotifySync;\n","import {\n  ENDPOINT_VOICE_RECORDING_CREATE,\n  ENDPOINT_VOICE_RECORDING_DELETE,\n} from '../../../config/api';\nimport { TYPE_POST } from '../../../config/global';\nimport { fetchBackend } from '../../../utils/network';\n\n\n/*\n * POST creates a voice recording.\n */\nexport const fetchCreateVoiceRecording = async (\n  audioFile, transcriptData, transcriptFinal\n) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_VOICE_RECORDING_CREATE,\n    { audioFile, transcriptData, transcriptFinal },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n\n/*\n * POST deletes a voice recording.\n */\nexport const fetchDeleteVoiceRecording = async (voiceRecordingUuid) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_VOICE_RECORDING_DELETE,\n    { voiceRecordingUuid },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","export const STYLE_BOLD = 'bold';\nexport const STYLE_ITALICIZE = 'italicize';\nexport const STYLE_STRIKETHROUGH = 'strikethrough';\nexport const STYLE_HIGHLIGHT = 'highlight';\n\n\nexport const STYLE_CHOICES = [\n  STYLE_BOLD,\n  STYLE_ITALICIZE,\n  STYLE_STRIKETHROUGH,\n  STYLE_HIGHLIGHT,\n];\n","import {\n  ENDPOINT_TEXT_COMMENT_MODIFICATION_CREATE,\n} from '../../../config/api';\nimport { TYPE_POST } from '../../../config/global';\nimport { fetchBackend } from '../../../utils/network';\n\n\n/*\n * POST creates a style modification for a text comment.\n */\nexport const fetchCreateTextCommentModification = async (\n  textCommentUuid, style, anchorOffset, focusOffset\n) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_TEXT_COMMENT_MODIFICATION_CREATE,\n    { textCommentUuid, style, anchorOffset, focusOffset },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","import React, { useRef, useState } from \"react\";\nimport { connect } from 'react-redux';\nimport Popover from 'react-text-selection-popover';\nimport styles from './NotableText.module.css';\nimport {\n  STYLE_BOLD,\n  STYLE_ITALICIZE,\n  STYLE_STRIKETHROUGH,\n  STYLE_HIGHLIGHT,\n  STYLE_CHOICES,\n} from './constants';\nimport { fetchCreateTextCommentModification } from './network';\n\n\nfunction NotableText(props) {\n\n  /*\n   * \n   */\n  const textColor = props.textColor;\n\n  const selectableRef = useRef(null);\n\n  const [selectableIsShowable, setSelectableIsShowable] = useState(true);\n  const [anchorOffset, setAnchorOffset] = useState(null);\n  const [focusOffset, setFocusOffset] = useState(null);\n\n  /*\n   * When the user highlights part of the comment.\n   */\n  const handleNotation = async function(style) {\n    const textCommentUuid = props.data.uuid;\n    const responseJson = await fetchCreateTextCommentModification(\n      textCommentUuid,\n      style,\n      anchorOffset,\n      focusOffset,\n    );\n    props.dispatch(responseJson.redux)\n    setSelectableIsShowable(false);\n  }\n\n  /*\n   * ...\n   */\n  const onTextSelect = async function() {\n    const selection = window.getSelection();\n\n    // // Invalid text selection\n    // if(selection.anchorNode !== selection.focusNode) {\n    //   setSelectableIsShowable(false);\n    //   setAnchorOffset(null);\n    //   setFocusOffset(null);\n    //   return;\n    // }\n\n    // NOTE: anchor is where the user starts selecting text, focus is the end\n    //       of the selection.\n    const anchorValue = parseInt(selection.anchorNode.parentNode.getAttribute('offset')) - 1;\n    const focusValue = parseInt(selection.focusNode.parentNode.getAttribute('offset'));\n    setSelectableIsShowable(true);\n    setAnchorOffset(anchorValue);\n    setFocusOffset(focusValue);\n  }\n\n  /*\n   * ...\n   */\n  const onTextUnselect = async function() {\n    setSelectableIsShowable(false);\n    setAnchorOffset(null);\n    setFocusOffset(null);\n  }\n\n  /*\n   * When rendering a text comment, the text has to be displayed along with all\n   * of its annotations. Here the comment string is spliced into many\n   * substrings. If a substring has an accompanying modification, then Rough\n   * Notation is used to display the underline, strike-through, or highlight.\n   */\n  const renderTextComment = function() {\n    const textComment = props.data,\n          textCommentText = textComment.text,\n          modifications = textComment.modifications;\n\n    // Initializes an array of empty sets.\n    const styles = [];\n    for(let i=0; i< textCommentText.length; i++) {\n      styles[i] = new Set();\n    }\n\n    // Adds styles to each set.\n    for(let i=0; i < modifications.length; i++) {\n      const modification = modifications[i];\n\n      for(let j=modification.startPtr; j < modification.endPtr; j++) {\n        styles[j].add(modification.style);\n      }\n    }\n\n    // Generate the comment\n    let textCommentHtml = <></>\n    for(let i=0; i < styles.length; i++) {\n      const char = textCommentText[i],\n            style = styles[i];\n\n      const stylesObj = {};\n      if(style.has(STYLE_BOLD)) {\n        stylesObj['fontWeight'] = 'bold';\n      }\n      if(style.has(STYLE_ITALICIZE)) {\n        stylesObj['fontStyle'] = 'italic';\n      }\n      if(style.has(STYLE_STRIKETHROUGH)) {\n        stylesObj['textDecoration'] = 'line-through';\n      }\n      if(style.has(STYLE_HIGHLIGHT)) {\n        stylesObj['backgroundColor'] = 'yellow';\n      }\n\n      textCommentHtml = <>\n        {textCommentHtml}\n        <span offset={i} style={stylesObj}>\n          {char}\n        </span>\n      </>\n    }\n\n    return textCommentHtml;\n\n  }\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.NotableText} style={{color: textColor}}>\n\n      <p ref={selectableRef}>\n        {renderTextComment()}\n      </p>\n\n      <Popover selectionRef={selectableRef} onTextSelect={onTextSelect} onTextUnselect={onTextUnselect} isOpen={selectableIsShowable}>\n        {STYLE_CHOICES.map((style, index) => {\n          return (\n            <button key={index}\n                    type=\"button\"\n                    onClick={async () => { await handleNotation(style); }}>\n              {style}\n            </button>\n          );\n        })}\n      </Popover>\n\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({});\n\n\nexport default connect(mapStateToProps)(NotableText);\n","import {\n  ENDPOINT_TEXT_COMMENT_DELETE,\n  ENDPOINT_TEXT_COMMENT_MODIFICATION_LIST_DELETE,\n} from '../../../config/api'\nimport { TYPE_POST } from '../../../config/global'\nimport { fetchBackend } from '../../../utils/network'\n\n\n/*\n * POST delete a text comment.\n */\nexport const fetchDeleteTextComment = async (textCommentUuid) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_TEXT_COMMENT_DELETE,\n    { textCommentUuid: textCommentUuid },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n\n/*\n * POST deletes all modifcations that belong to a text comment.\n */\nexport const fetchListDeleteTextCommentModifications = async (\n  textCommentUuid\n) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_TEXT_COMMENT_MODIFICATION_LIST_DELETE,\n    { textCommentUuid: textCommentUuid },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","import React from \"react\";\nimport { connect } from 'react-redux';\nimport NotableText from '../NotableText/NotableText';\nimport styles from './TextComment.module.css';\nimport {\n  fetchDeleteTextComment,\n  fetchListDeleteTextCommentModifications,\n} from './network';\n\n\nfunction TextComment(props) {\n\n  /*\n   * \n   */\n  const textComment = props.data,\n        textCommentUuid = textComment.uuid;\n\n  /*\n   * Deletes a text comment.\n   */\n  const deleteTextComment = async function() {\n    const responseJson = await fetchDeleteTextComment(textCommentUuid);\n    props.dispatch(responseJson.redux);\n  }\n\n  /*\n   * Clears all styled modifications on this text comment.\n   */\n  const clearModifications = async function() {\n    const responseJson = await fetchListDeleteTextCommentModifications(textCommentUuid);\n    await props.dispatch(responseJson.redux);\n  }\n\n  let textColor;\n  if(textComment.renderStatus === 'history') {\n    textColor = 'grey';\n  } else if(textComment.renderStatus === 'display') {\n    textColor = 'black';\n  } else {\n    textColor = 'red';\n  }\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.TextComment}>\n      <NotableText data={textComment} textColor={textColor}></NotableText>\n\n      <button type=\"button\" onClick={clearModifications}>\n        Clear modifications\n      </button>\n\n      <button type=\"button\" onClick={deleteTextComment}>\n        Delete\n      </button>\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({});\n\n\nexport default connect(mapStateToProps)(TextComment);\n","import React from \"react\";\nimport { connect } from 'react-redux';\nimport { Notation } from 'react-abc';\nimport styles from './ABCNotationDisplay.module.css';\nimport { fetchDeleteTextComment } from '../TextComment/network';\n\n\nfunction ABCNotationDisplay(props) {\n\n  /*\n   * \n   */\n  const abcNotation = props.data,\n        abcNotationUuid = abcNotation.uuid;\n\n  /*\n   * Deletes a music notation graphic.\n   *\n   * NOTE: ABCNotation is a proxy model of TextComment. Everything underneath\n   * the hood runs inside TextComment.\n   */\n  const deleteAbcNotation = async function() {\n    const responseJson = await fetchDeleteTextComment(abcNotationUuid);\n    props.dispatch(responseJson.redux);\n  }\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.ABCNotationDisplay}>\n\n      <Notation notation={abcNotation.text}\n                engraverParams={{ staffwidth: 278 }}/>\n\n      <button type=\"button\" onClick={deleteAbcNotation}>\n        Delete\n      </button>\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({});\n\n\nexport default connect(mapStateToProps)(ABCNotationDisplay);\n","import React, { useState } from \"react\";\nimport Modal from 'react-modal';\nimport { Notation } from 'react-abc';\nimport { connect } from 'react-redux';\nimport { fetchTextCommentCreate } from './../network';\n\n\nfunction ABCNotationCompose(props) {\n\n  /*\n   * \n   */\n  const trackUuid = props.trackUuid,\n        textCommentTimestamp = props.textCommentTimestamp,\n        format = 'abc_notation',\n        isOpen = props.isOpen,\n        closeModal = props.closeModal;\n\n  const [isDisabled, setIsDisabled] = useState(false);\n  const [text, setText] = useState('');\n\n  /*\n   * When a user submits a new comment.\n   */\n  const createABCNotation = async function() {\n    setIsDisabled(true);\n    const responseJson = await fetchTextCommentCreate(\n      text, format, trackUuid, textCommentTimestamp\n    );\n\n    props.dispatch(responseJson.redux);\n    closeModal();\n    setText('');\n    setIsDisabled(false);\n  }\n\n  const handleTextChange = function(e) {\n    setText(e.target.value);\n  }\n\n  return (\n    <Modal isOpen={isOpen}\n           ariaHideApp={false}>\n      <button onClick={closeModal}\n              disabled={isDisabled}>\n        Close\n      </button>\n\n      <br></br><br></br>\n\n      <div>\n        <textarea type=\"text\"\n                  name=\"text\"\n                  placeholder=\"text\"\n                  value={text}\n                  onChange={handleTextChange}\n                  disabled={isDisabled} />\n\n        <Notation notation={text}\n                  engraverParams={{ staffwidth: 278 }}/>\n      </div>\n\n      <button onClick={createABCNotation}\n              disabled={isDisabled}>\n        Post\n      </button>\n    </Modal>\n  );\n}\n\nconst mapStateToProps = (state) => ({});\n\nexport default connect(mapStateToProps)(ABCNotationCompose);\n","import React from \"react\";\nimport { connect } from 'react-redux';\nimport styles from './VoiceRecording.module.css';\nimport { fetchDeleteVoiceRecording } from './network';\n\n\nfunction VoiceRecording(props) {\n\n  /*\n   * \n   */\n  const voiceRecording = props.data,\n        voiceRecordingUuid = voiceRecording.uuid;\n\n  /*\n   * Delete a voice recording.\n   */\n  const handleDelete = async function() {\n    await fetchDeleteVoiceRecording(voiceRecordingUuid);\n    props.dispatch({\n      type: 'voiceRecording/delete',\n      voiceRecordingUuid: voiceRecordingUuid,\n    });\n  }\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.VoiceRecording}>\n      <p>\n        <i>\n          {\n            voiceRecording.transcriptFinal === 'null' ?\n              '<transcript not available>' :\n              voiceRecording.transcriptFinal\n          }\n        </i>\n      </p>\n      <button type=\"submit\" onClick={handleDelete}>\n        Delete\n      </button>\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({});\n\n\nexport default connect(mapStateToProps)(VoiceRecording);\n","import React, { useState, useEffect } from \"react\";\nimport { connect } from 'react-redux';\nimport SpeechRecognition, { useSpeechRecognition } from 'react-speech-recognition';\nimport MicRecorder from 'mic-recorder-to-mp3';\nimport styles from './FeedApp.module.css';\nimport { fetchTextCommentCreate } from './network';\nimport { fetchCreateVoiceRecording } from './VoiceRecording/network';\nimport TextComment from './TextComment/TextComment';\nimport ABCNotationDisplay from './ABCNotationDisplay/ABCNotationDisplay';\nimport ABCNotationCompose from './ABCNotationCompose/ABCNotationCompose';\nimport VoiceRecording from './VoiceRecording/VoiceRecording';\nimport { CLASS_TEXT_COMMENT, CLASS_VOICE_RECORDING } from '../../config/model';\nimport { getPositionMilliseconds } from '../PlaybackApp/utils';\n\n\nfunction FeedApp(props) {\n\n  /*\n   * \n   */\n  const feed = props.feed,\n        stream = props.stream;\n\n  const [text, setText] = useState('');\n  const [trackUuid, setTrackUuid] = useState(undefined);\n  const [textCommentTimestamp, setTextCommentTimestamp] = useState(undefined);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recorder] = useState(new MicRecorder({ bitRate: 320 }));\n  const [transcriptData] = useState([]);\n\n  const [showModal, setShowModal] = useState(false);\n\n  const openModal = function() {\n    const arr = getPositionMilliseconds(stream, stream.startedAt),\n          position = arr[0];\n    setTextCommentTimestamp(position);\n    setTrackUuid(stream.nowPlaying.track.uuid);\n    setShowModal(true);\n  }\n\n  const closeModal = function() {\n    setShowModal(false);\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  // REGENERATE THE FEED\n  useEffect(() => {\n\n    const periodicTask = setInterval(() => {\n      props.dispatch({ type: \"feed/update\" });\n    }, 50);\n\n    return () => {\n      clearInterval(periodicTask);\n    }\n\n  // eslint-disable-next-line\n  }, []);\n\n  const handleTextChange = function(e) {\n    if(!trackUuid) {\n      const arr = getPositionMilliseconds(stream, stream.startedAt),\n            position = arr[0];\n      setTextCommentTimestamp(position);\n      setTrackUuid(stream.nowPlaying.track.uuid);\n    }\n    setText(e.target.value);\n  }\n\n  /*\n   * When a user submits a new comment.\n   */\n  const createTextComment = async function(e) {\n    e.preventDefault();\n    const format = 'text';\n    const responseJson = await fetchTextCommentCreate(\n      text, format, trackUuid, textCommentTimestamp\n    );\n\n    props.dispatch(responseJson.redux);\n    setTextCommentTimestamp(undefined);\n    setTrackUuid(undefined);\n    setText('');\n  }\n\n  const { transcript, resetTranscript } = useSpeechRecognition();\n\n  /*\n   * ...\n   */\n  const handleRecord = function() {\n    if(!isRecording) {\n      if (SpeechRecognition.browserSupportsSpeechRecognition()) {\n        SpeechRecognition.startListening({ continuous: true });\n        // BUG: https://github.com/JamesBrill/react-speech-recognition/issues/81\n        //\n        // const recognition = SpeechRecognition.getRecognition();\n        // recognition.onresult = (e) => {\n        //   recognition.onresult(e);\n        //   const timeStamp = e.timeStamp,\n        //         transcript = e.results[0][0].transcript,\n        //         confidence = e.results[0][0].confidence,\n        //         isFinal = e.results[0].isFinal;\n        //   transcriptData.push({ timeStamp, transcript, confidence, isFinal });\n        //   setTranscriptData([...transcriptData]);\n        // }\n      }\n      recorder.start();\n      setIsRecording(true);\n    } else {\n      if (SpeechRecognition.browserSupportsSpeechRecognition()) {\n        SpeechRecognition.stopListening();\n      }\n\n      recorder.stop()\n        .getMp3().then(([buffer, blob]) => {\n          (async function () {\n            const file = new File(buffer, 'voice.mp3', {\n              type: blob.type,\n              lastModified: Date.now(),\n            });\n\n            const responseJson = await fetchCreateVoiceRecording(file, JSON.stringify(transcriptData), transcript);\n\n            await props.dispatch({\n              type: 'voiceRecording/create',\n              voiceRecording: responseJson.data,\n            });\n\n            if (SpeechRecognition.browserSupportsSpeechRecognition()) {\n              resetTranscript();\n            }\n          })()\n        });\n\n      setIsRecording(false);\n    }\n  }\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.FeedApp}>\n      <div className={styles.Feed}>\n        <div className={styles.FeedWrapper}>\n          {feed.map((value, index) => {\n            if(value.class === CLASS_TEXT_COMMENT) {\n              if(value.format === 'text') {\n                return <TextComment key={index} data={value} />;\n              } else if(value.format === 'abc_notation') {\n                return <ABCNotationDisplay key={index} data={value} />;\n              }\n            } else if(value.class === CLASS_VOICE_RECORDING) {\n              return <VoiceRecording key={index} data={value} />\n            }\n            return <></>;\n          })}\n        </div>\n      </div>\n\n      <form className={styles.CreateTextComment} onSubmit={async (e) => { await createTextComment(e); }}>\n        <button type=\"button\"\n                onClick={openModal}\n                disabled={!stream.isPlaying} >\n          Notation\n        </button>\n\n        <ABCNotationCompose trackUuid={trackUuid}\n                            textCommentTimestamp={textCommentTimestamp}\n                            isOpen={showModal}\n                            closeModal={closeModal} />\n        <button type=\"button\"\n                onClick={handleRecord}\n                disabled={!stream.isPlaying} >\n          Record\n        </button>\n        <input type=\"text\"\n               name=\"text\"\n               placeholder=\"text\"\n               value={text}\n               onChange={handleTextChange}\n               disabled={!stream.isPlaying} />\n        <button type=\"submit\"\n                disabled={!stream.isPlaying} >\n          Send\n        </button>\n      </form>\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n    stream: state.stream,\n    textComments: state.textComments,\n    voiceRecordings: state.voiceRecordings,\n    feed: state.feed,\n});\n\n\nexport default connect(mapStateToProps)(FeedApp);\n","const CLASS_TEXT_COMMENT = 'TextComment'\nconst CLASS_VOICE_RECORDING = 'VoiceRecording'\n\nexport { CLASS_TEXT_COMMENT, CLASS_VOICE_RECORDING }\n","import React from \"react\";\nimport styles from './MiniFeed.module.css';\n\n\nfunction MiniFeed(props) {\n\n  return (\n    <div className={styles.MiniFeed}>\n      <h3><i>Feed...</i></h3>\n    </div>\n  );\n}\n\n\nexport default MiniFeed;\n","import {\n  ENDPOINT_MARKER_CREATE,\n  ENDPOINT_MARKER_DELETE,\n  ENDPOINT_MARKER_LIST,\n} from '../../../config/api';\nimport { TYPE_GET, TYPE_POST } from '../../../config/global';\nimport { fetchBackend } from '../../../utils/network';\n\n\n/*\n * Creates a marker. The queue context is passed so the Redux state may be\n * updated.\n */\nexport const fetchStreamMarkerCreate = async (trackUuid, timestampMilliseconds, queueUuid) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_MARKER_CREATE,\n    { trackUuid, timestampMilliseconds, queueUuid }\n  );\n  return await response.json();\n};\n\n\n/*\n * Deletes a marker. The queue context is passed so the Redux state may be\n * updated.\n */\nexport const fetchStreamMarkerDelete = async (markerUuid, queueUuid) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_MARKER_DELETE,\n    { markerUuid, queueUuid }\n  );\n  return await response.json();\n};\n\n/*\n * Fetches a list of markers for a given track. The queue context is passed so\n * the Redux state may be updated.\n */\nexport const fetchStreamMarkerList = async (trackUuid, queueUuid) => {\n  const response = await fetchBackend(\n    TYPE_GET,\n    ENDPOINT_MARKER_LIST,\n    { trackUuid, queueUuid }\n  );\n  return await response.json();\n};\n","import {\n  ENDPOINT_QUEUE_INTERVAL_CREATE,\n  ENDPOINT_QUEUE_INTERVAL_DELETE,\n} from '../../../config/api';\nimport { TYPE_POST } from '../../../config/global';\nimport { fetchBackend } from '../../../utils/network';\n\n/*\n * Fetches...\n */\nexport const fetchStreamQueueIntervalCreate = async (queueUuid, lowerBoundMarkerUuid, upperBoundMarkerUuid, purpose, repeatCount, parentQueueUuid) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_QUEUE_INTERVAL_CREATE,\n    { queueUuid, lowerBoundMarkerUuid, upperBoundMarkerUuid, purpose, repeatCount, parentQueueUuid }\n  );\n  return await response.json();\n};\n\n\n/*\n * Fetches...\n */\nexport const fetchStreamQueueIntervalDelete = async (queueIntervalUuid, queueUuid, parentQueueUuid) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_QUEUE_INTERVAL_DELETE,\n    { queueIntervalUuid, queueUuid, parentQueueUuid }\n  );\n  return await response.json();\n};\n","import React from \"react\";\nimport { connect } from 'react-redux';\nimport { fetchStreamQueueIntervalDelete } from './network';\n\n\nfunction Interval(props) {\n\n  const { queueInterval, queueUuid, parentQueueUuid } = props.data;\n\n  const deleteQueueInterval = async function() {\n    const responseJson = await fetchStreamQueueIntervalDelete(\n      queueInterval.uuid, queueUuid, parentQueueUuid\n    );\n    await props.dispatch(responseJson.redux);\n  }\n\n  const purpose = queueInterval.purpose;\n  const lowerBound = queueInterval.lowerBound ?\n    queueInterval.lowerBound.timestampMilliseconds / 1000 : 'beginning';\n  const upperBound = queueInterval.upperBound ?\n    queueInterval.upperBound.timestampMilliseconds / 1000 : 'end';\n\n  return (\n    <div>\n      <span>\n        [{purpose}]\n        {lowerBound} =>\n        {upperBound}\n      </span>\n      <button onClick={deleteQueueInterval}>Delete</button>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => ({});\n\nexport default connect(mapStateToProps)(Interval);\n","import React from \"react\";\nimport { connect } from 'react-redux';\nimport { fetchStreamMarkerDelete } from './network';\n\n\nfunction Marker(props) {\n\n  const { trackMarker, queueUuid } = props.data;\n\n  const deleteTrackMarker = async function() {\n    const responseJson = await fetchStreamMarkerDelete(\n      trackMarker.uuid, queueUuid\n    );\n    await props.dispatch(responseJson.redux);\n  }\n\n  return (\n    <div>\n      <span>\n        @ {trackMarker.timestampMilliseconds / 1000}\n      </span>\n      <button onClick={deleteTrackMarker}>Delete</button>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => ({});\n\nexport default connect(mapStateToProps)(Marker);\n","import React, { useState, useEffect } from \"react\";\nimport { connect } from 'react-redux';\nimport Modal from 'react-modal';\nimport {\n  fetchStreamMarkerCreate,\n  fetchStreamMarkerList,\n} from './Marker/network';\nimport Interval from './Interval/Interval';\nimport {\n  fetchStreamQueueIntervalCreate,\n} from './Interval/network';\nimport Marker from './Marker/Marker'\n\n\nfunction TrackDetailApp(props) {\n\n  /*\n   * \n   */\n  const queue = props.data,\n        queueUuid = queue.uuid,\n        parentQueueUuid = queue.parentUuid,\n        // modal\n        shouldOpenModal = props.shouldOpenModal,\n        setShouldOpenModal = props.setShouldOpenModal,\n        isOpen = props.isOpen,\n        openModal = props.openModal,\n        closeModal = props.closeModal,\n        // Redux\n        trackMarkerMap = props.trackMarkerMap,\n        markers = trackMarkerMap[queueUuid] || [];\n\n  const [purpose, setPurpose] = useState('muted');\n  const [formMarkerTimestamp, setFormMarkerTimestamp] = useState('');\n  const [lowerBoundMarkerUuid, setLowerBoundMarkerUuid] = useState('null');\n  const [upperBoundMarkerUuid, setUpperBoundMarkerUuid] = useState('null');\n\n  /*\n   * Create a marker.\n   */\n  const createTrackMarker = async function() {\n    const responseJson = await fetchStreamMarkerCreate(\n      queue.track.uuid, formMarkerTimestamp, queueUuid\n    );\n    await props.dispatch(responseJson.redux);\n    setFormMarkerTimestamp('');\n  }\n\n  /*\n   * Create an interval. Right now, the only interval is \"muted.\"\n   */\n  const createQueueInterval = async function() {\n    const responseJson = await fetchStreamQueueIntervalCreate(\n      queue.uuid,\n      lowerBoundMarkerUuid,\n      upperBoundMarkerUuid,\n      purpose,\n      null,\n      parentQueueUuid,\n    );\n    await props.dispatch(responseJson.redux);\n  }\n\n  ////////////////////////////////////////////////////////\n  // load markers that need to be displayed in the modal\n  useEffect(() => {\n    async function loadData() {\n      const responseJson = await fetchStreamMarkerList(\n        queue.track.uuid, queueUuid\n      );\n      await props.dispatch(responseJson.redux);\n      openModal();\n    }\n    if(!shouldOpenModal) {\n      return;\n    }\n    setShouldOpenModal(false);\n    loadData();\n  // eslint-disable-next-line\n  }, [shouldOpenModal])\n\n  /*\n   * \n   */\n  return (\n    <Modal isOpen={isOpen}\n           ariaHideApp={false}>\n      <button onClick={closeModal}>Close</button>\n      <p>Markers</p>\n      {markers.map((value, index) => (\n        <Marker key={index}\n                     data={{\n                       trackMarker: value,\n                       queueUuid: queueUuid,\n                     }} />\n      ))}\n      <div>\n        <input type=\"text\"\n               name=\"timestampMilliseconds\"\n               placeholder=\"timestamp\"\n               value={formMarkerTimestamp}\n               onChange={(e) => {setFormMarkerTimestamp(e.target.value)}} />\n        <button onClick={createTrackMarker}>Create Marker</button>\n      </div>\n      <p>Intervals</p>\n      {queue.intervals.map((value, index) => (\n        <Interval key={index}\n                       data={{\n                         queueInterval: value,\n                         queueUuid: queueUuid,\n                         parentQueueUuid: parentQueueUuid,\n                       }} />\n      ))}\n      <div>\n        <select value={purpose} onChange={(e) => {setPurpose(e.target.value)}}>\n          <option value={'muted'}>Muted</option>\n          <option value={'drums'}>Solo drums</option>\n          <option value={'vocals'}>Solo vocals</option>\n          <option value={'bass'}>Solo bass</option>\n          <option value={'other'}>Solo other</option>\n        </select>\n        <select value={lowerBoundMarkerUuid} onChange={(e) => {setLowerBoundMarkerUuid(e.target.value)}}>\n          <option value={'null'}>Beginning</option>\n          {markers.map((value, index) => (\n            <option key={index} value={value.uuid}>@ {value.timestampMilliseconds}</option>\n          ))}\n        </select>\n        <select value={upperBoundMarkerUuid} onChange={(e) => {setUpperBoundMarkerUuid(e.target.value)}}>\n          {markers.map((value, index) => (\n            <option key={index} value={value.uuid}>@ {value.timestampMilliseconds}</option>\n          ))}\n          <option value={'null'}>End</option>\n        </select>\n        <button onClick={createQueueInterval}>Create Interval</button>\n      </div>\n    </Modal>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  trackMarkerMap: state.trackMarkerMap,\n});\n\nexport default connect(mapStateToProps)(TrackDetailApp);\n","import React, { useState } from \"react\";\nimport { connect } from 'react-redux'\nimport TrackDetailApp from '../../TrackDetailApp/TrackDetailApp'\nimport styles from './QueueTrack.module.css';\n\n\nfunction QueueTrack(props) {\n\n  /*\n   * \n   */\n  const queue = props.data,\n        stream = props.stream,\n        lastUp = props.lastUp;\n\n  const [showModal, setShowModal] = useState(false);\n  const [shouldOpenModal, setShouldOpenModal] = useState(false);\n\n  const initializeModal = function() {\n    setShouldOpenModal(true);\n  }\n\n  const openModal = function() {\n    setShowModal(true);\n  }\n\n  const closeModal = function() {\n    setShowModal(false);\n  }\n\n  /*\n   * \n   */\n  const currentIndex = stream?.nowPlaying?.index || lastUp?.index,\n        isNextUp = !currentIndex || currentIndex < queue.index,\n        indent = queue.parentUuid && isNextUp ? '-' : '';\n  return (\n    <div className={styles.QueueTrack}>\n      <span>\n        {indent}\n        {queue.track.name}\n      </span>\n      {isNextUp &&\n        <>\n          <button className={styles.Button} type=\"button\" onClick={initializeModal}>\n            Edit\n          </button>\n          <button className={styles.Button} type=\"button\" onClick={async (e) => { await props.destroy(queue); }}>\n            Delete\n          </button>\n        </>\n      }\n      <TrackDetailApp data={queue}\n                 isOpen={showModal}\n                 shouldOpenModal={shouldOpenModal}\n                 setShouldOpenModal={setShouldOpenModal}\n                 openModal={openModal}\n                 closeModal={closeModal} />\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  stream: state.stream,\n  lastUp: state.lastUp,\n});\n\nexport default connect(mapStateToProps)(QueueTrack);\n","import React, { useState } from \"react\";\nimport { connect } from 'react-redux'\nimport styles from './QueueCollection.module.css';\nimport QueueTrack from '../QueueTrack/QueueTrack'\n\n\nfunction QueueCollection(props) {\n\n  /*\n   * \n   */\n  const queue = props.data,\n        stream = props.stream,\n        lastUpQueues = props.lastUpQueues,\n        lastUp = lastUpQueues[lastUpQueues.length - 1],\n        queueUuid = queue.uuid;\n\n  const isCurrentlyPlayingCollection = (\n    // Stream is NOW playing - \"now playing\" belongs to same parent UUID\n    (stream?.nowPlaying && stream?.nowPlaying?.parentUuid === queueUuid) ||\n    // Stream is NOT playing - \"last up\" belongs to same parent UUID\n    (!stream?.nowPlaying && lastUp?.parentUuid && lastUp?.parentUuid === queueUuid)\n  );\n\n\n  const [reveal, setReveal] = useState(isCurrentlyPlayingCollection);\n\n  /*\n   * When...\n   */\n  const toggleReveal = function(e) {\n    setReveal(!reveal);\n  }\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.QueueCollection}>\n      <div className={styles.Item}>\n        <span>\n          <i>\n            {queue.collection.name}\n          </i>\n        </span>\n        &nbsp;&nbsp;\n        {queue.children.length > 0 && !reveal &&\n          <button className={styles.Button} type=\"button\" onClick={toggleReveal}>\n            More\n          </button>\n        }&nbsp;&nbsp;\n        {queue.children.length > 0 && reveal &&\n          <button className={styles.Button} type=\"button\" onClick={toggleReveal}>\n            Less\n          </button>\n        }&nbsp;&nbsp;\n        {!isCurrentlyPlayingCollection &&\n          <button className={styles.Button} type=\"button\" onClick={async (e) => { await props.destroy(queue); }}>\n            Delete\n          </button>\n        }\n      </div>\n      {queue.children.length > 0 && reveal &&\n        <div className={styles.Children}>\n          {queue.children.map((value, index) => (\n            <QueueTrack key={index}\n                        data={value}\n                        destroy={props.destroy}>\n            </QueueTrack>\n          ))}\n        </div>\n      }\n    </div>\n  );\n\n}\n\nconst mapStateToProps = (state) => ({\n  stream: state.stream,\n  lastUpQueues: state.lastUpQueues,\n});\n\nexport default connect(mapStateToProps)(QueueCollection);\n","import { connect } from 'react-redux'\nimport { Link } from \"react-router-dom\";\nimport styles from './QueueApp.module.css';\nimport { fetchDeleteQueue } from './network'\nimport QueueCollection from './QueueCollection/QueueCollection'\nimport QueueTrack from './QueueTrack/QueueTrack'\nimport { getQueueDuration } from './utils';\nimport ReactTimeAgo from 'react-time-ago';\n\n\nfunction QueueApp(props) {\n\n  const nextUpQueues = props.nextUpQueues,\n        stream = props.stream,\n        nowPlayingTrackName = stream?.nowPlaying?.track?.name;\n\n  const queueDuration = getQueueDuration(nextUpQueues, stream);\n  const endsAt = new Date(Date.now() + queueDuration);\n\n  /*\n   * Called inside a child component, this first deletes the queue from the\n   * backend, then, on success, it deletes it from the front-end model and\n   * view.\n   */\n  const destroyQueueItem = async function(queue) {\n    const queueUuid = queue.uuid;\n\n    await fetchDeleteQueue(queueUuid);\n\n    const parentUuid = queue.parentUuid;\n    if(parentUuid) {\n      props.dispatch({\n        type: 'queue/deleteChildNode',\n        parentUuid: parentUuid,\n        queueUuid: queueUuid,\n      });\n    } else {\n      props.dispatch({\n        type: 'queue/deleteNode',\n        queueUuid: queueUuid,\n      });\n    }\n  }\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.QueueApp}>\n      <h4><i>Last up...</i></h4>\n      <div>\n        {  // eslint-disable-next-line\n        props.lastUpQueues.map((value, index) => {\n          if(value.track) {\n            return (\n              <QueueTrack key={index}\n                          data={value}\n                          destroy={() => {}}>\n              </QueueTrack>\n            );\n          }\n        })}\n      </div>\n      <div>\n        <h4><i>Now playing...</i></h4>\n        {nowPlayingTrackName ?\n          (\n            <p>{nowPlayingTrackName}</p>\n          ) : (\n            <p><i>Nothing is playing...</i></p>\n          )\n        }\n      </div>\n      <h2><i>Next up...</i></h2>\n      <div>\n        {  // eslint-disable-next-line\n        nextUpQueues.map((value, index) => {\n          if(value.collection) {\n            return (\n              <QueueCollection key={value.uuid}\n                               data={value}\n                               destroy={destroyQueueItem}>\n              </QueueCollection>\n            );\n          } else if(value.track) {\n            return (\n              <QueueTrack key={value.uuid}\n                          data={value}\n                          destroy={destroyQueueItem}>\n              </QueueTrack>\n            );\n          }\n        })}\n        {queueDuration ?\n          (\n            <p><i>\n              Playback will end&nbsp;\n              <ReactTimeAgo future date={endsAt} locale=\"en-US\" />\n            </i></p>\n          ) : (\n            <p><i>\n              There is nothing in the queue.\n            </i></p>\n          )\n        }\n        <Link to=\"/app/search\">\n          <button className={styles.AddToQueue}>\n            Add to Queue\n          </button>\n        </Link>\n      </div>\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n  stream: state.stream,\n  nextUpQueues: state.nextUpQueues,\n  lastUpQueues: state.lastUpQueues,\n});\n\n\nexport default connect(mapStateToProps)(QueueApp);\n","import { connect } from 'react-redux'\nimport styles from './MiniQueue.module.css';\nimport { getQueueDuration, flattenQueues } from '../utils';\nimport ReactTimeAgo from 'react-time-ago';\n\n\nfunction MiniQueue(props) {\n\n  const nextUpQueues = props.nextUpQueues,\n        stream = props.stream;\n\n  let flattenedQueue, expandedQueues;\n  if(nextUpQueues.length) {\n    flattenedQueue = flattenQueues([nextUpQueues[0]]);\n    expandedQueues = [...flattenedQueue, ...nextUpQueues.slice(1)];\n  } else {\n    expandedQueues = [];\n  }\n\n  // TODO needs to add however much is left inside now playing.\n  const queueDuration = getQueueDuration(nextUpQueues, stream);\n  const endsAt = new Date(Date.now() + queueDuration);\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.MiniQueue}>\n      <h3><i>Next up...</i></h3>\n      {queueDuration ?\n        (\n          <p><i>\n            Playback will end&nbsp;\n            <ReactTimeAgo future date={endsAt} locale=\"en-US\" />\n          </i></p>\n        ) : (\n          <p><i>\n            There is nothing in the queue.\n          </i></p>\n        )\n      }\n      <div>\n        {expandedQueues.map((queue, index) => {\n          return (\n            <div key={index} className={styles.MiniQueueItem}>\n              {queue.track?.name || queue.collection?.name}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n  nextUpQueues: state.nextUpQueues,\n  stream: state.stream,\n});\n\n\nexport default connect(mapStateToProps)(MiniQueue);\n","import { ENDPOINT_MUSIC_SEARCH, ENDPOINT_QUEUE_CREATE } from '../../config/api'\nimport { TYPE_GET, TYPE_POST } from '../../config/global'\nimport { fetchBackend } from '../../utils/network'\n\n/*\n * Fetches an auth token from the server.\n */\nexport const fetchSearchMusicLibrary = async (query, providerAppleMusic, providerSpotify, providerYouTube, providerJukeboxRadio, formatTrack, formatAlbum, formatPlaylist, formatVideo) => {\n  const response = await fetchBackend(\n    TYPE_GET,\n    ENDPOINT_MUSIC_SEARCH,\n    {\n      query,\n      providerAppleMusic,\n      providerSpotify,\n      providerYouTube,\n      providerJukeboxRadio,\n      formatTrack,\n      formatAlbum,\n      formatPlaylist,\n      formatVideo,\n    },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n\n\n/*\n * Fetches an auth token from the server.\n */\nexport const fetchCreateQueue = async (className, genericUuid) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_QUEUE_CREATE,\n    { className, genericUuid },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","export const iconCheck = (\n  <svg\n    width=\"20\"\n    height=\"20\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      d=\"M10.5858 13.4142L7.75735 10.5858L6.34314 12L10.5858 16.2427L17.6568 9.1716L16.2426 7.75739L10.5858 13.4142Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n)\n","import React, { useState } from 'react';\nimport styles from './SearchResult.module.css';\nimport { iconCheck } from './icons';\n\n\nfunction SearchResult(props) {\n  const searchResult = props.data,\n        addToQueue = props.addToQueue;\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isSubmitted, setIsSubmitted] = useState(false);\n\n  const handleAddToQueue = async function() {\n    setIsSubmitting(true);\n    await addToQueue(searchResult.class, searchResult.uuid);\n    setIsSubmitted(true);\n  }\n\n  return (\n    <div className={styles.SearchResult}>\n      <span>\n        {searchResult.provider} {searchResult.format} {searchResult.name}\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n      </span>\n\n      { /* Initial state: button has not been clicked. */\n      !isSubmitting && !isSubmitted &&\n        <button type=\"button\"\n                className={styles.Button}\n                onClick={handleAddToQueue}\n                disabled={false}>\n          Add\n        </button>\n      }\n\n      { /* Immediately after being clicked, disable and display spinner. */\n      isSubmitting && !isSubmitted &&\n        <button type=\"button\"\n                className={styles.Button}\n                disabled={true}>\n          <i className={styles.ggSpinner}></i>\n        </button>\n      }\n\n      { /* Once loaded, stay disabled but display a check */\n      isSubmitted &&\n        <button type=\"button\"\n                className={styles.Button}\n                disabled={true}>\n          {iconCheck}\n        </button>\n      }\n    </div>\n  );\n}\n\nexport default SearchResult;\n","import { ENDPOINT_TRACK_CREATE } from '../../config/api'\nimport { TYPE_POST } from '../../config/global'\nimport { fetchBackend } from '../../utils/network'\n\n/*\n * Fetches...\n */\nexport const fetchCreateTrack = async (audioFile, imageFile, trackName, artistName, albumName) => {\n  const response = await fetchBackend(\n    TYPE_POST,\n    ENDPOINT_TRACK_CREATE,\n    {\n      audioFile: audioFile,\n      imageFile: imageFile,\n      trackName: trackName,\n      artistName: artistName,\n      albumName: albumName,\n    },\n  );\n  const responseJson = await response.json();\n  return responseJson;\n};\n","import React, { useState } from \"react\";\nimport Modal from 'react-modal';\nimport styles from './Upload.module.css';\n\nimport { fetchCreateTrack } from './network';\n\n\nfunction Upload(props) {\n\n  /*\n   * \n   */\n  const [inputKey, setInputKey] = useState(0);\n\n  const [isDisabled, setIsDisabled] = useState(false);\n  const [audioFile, setAudioFile] = useState('');\n  const [imageFile, setImageFile] = useState('');\n  const [trackName, setTrackName] = useState('');\n  const [artistName, setArtistName] = useState('');\n  const [albumName, setAlbumName] = useState('');\n\n  const isOpen = props.isOpen,\n        closeModal = props.closeModal;\n\n  /*\n   * When the user initializes a login attempt.\n   */\n  const handleSubmit = async function() {\n\n    // Hit the server.\n    setIsDisabled(true);\n    await fetchCreateTrack(\n      audioFile,\n      imageFile,\n      trackName,\n      artistName,\n      albumName,\n    );\n\n    // Reset the form.\n    setIsDisabled(false);\n    setInputKey(prev => prev + 2);\n    setTrackName('');\n    setArtistName('');\n    setAlbumName('');\n\n    // Close the modal.\n    closeModal();\n  }\n\n  return (\n    <Modal isOpen={isOpen}\n           ariaHideApp={false}>\n      <button onClick={closeModal}\n              disabled={isDisabled}>Close</button>\n\n      <div className={styles.Login}>\n        <h3>Upload</h3>\n\n        <label className={styles.FormBlock}>\n          Audio file\n          <input type=\"file\"\n                 name=\"audioFile\"\n                 onChange={(e) => {setAudioFile(e.target.files[0])}}\n                 disabled={isDisabled}\n                 key={inputKey} />\n        </label>\n\n        <label className={styles.FormBlock}>\n          Image file\n          <input type=\"file\"\n                 name=\"imageFile\"\n                 onChange={(e) => {setImageFile(e.target.files[0])}}\n                 disabled={isDisabled}\n                 key={inputKey + 1} />\n        </label>\n\n        <br></br>\n\n        <label className={styles.FormBlock}>\n          Track name\n          <input type=\"text\"\n                 name=\"trackName\"\n                 placeholder=\"Track name\"\n                 value={trackName}\n                 onChange={(e) => {setTrackName(e.target.value)}}\n                 disabled={isDisabled} />\n        </label>\n\n        <label className={styles.FormBlock}>\n          Artist name\n          <input type=\"text\"\n                 name=\"artistName\"\n                 placeholder=\"Artist name\"\n                 value={artistName}\n                 onChange={(e) => {setArtistName(e.target.value)}}\n                 disabled={isDisabled} />\n        </label>\n\n        <label className={styles.FormBlock}>\n          Album name\n          <input type=\"text\"\n                 name=\"albumName\"\n                 placeholder=\"Album name\"\n                 value={albumName}\n                 onChange={(e) => {setAlbumName(e.target.value)}}\n                 disabled={isDisabled} />\n        </label>\n\n        <br></br>\n\n        <div className={styles.FormBlock}>\n          <button type=\"submit\"\n                  onClick={handleSubmit}\n                  disabled={isDisabled}>\n            Submit\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nexport default Upload;\n","import React, { useState } from \"react\";\nimport { connect } from 'react-redux';\nimport styles from './SearchApp.module.css';\n\nimport { fetchSearchMusicLibrary, fetchCreateQueue } from './network';\nimport SearchResult from './SearchResult/SearchResult';\nimport Upload from '../Upload/Upload';\nimport { fetchQueueList } from '../QueueApp/network';\n\n\nfunction SearchApp(props) {\n\n  /*\n   * \n   */\n\n  const [searchResults, setSearchResults] = useState([]);\n\n  const [query, setQuery] = useState('');\n\n  // NOTE: These could be condensed, but I prefer explicitly writing them out.\n  const [serviceAppleMusic, setServiceAppleMusic] = useState(true);\n  const [serviceSpotify, setServiceSpotify] = useState(true);\n  const [serviceYouTube, setServiceYouTube] = useState(true);\n  const [serviceJukeboxRadio, setServiceJukeboxRadio] = useState(true);\n\n  const [formatTrack, setFormatTrack] = useState(true);\n  const [formatAlbum, setFormatAlbum] = useState(true);\n  const [formatPlaylist, setFormatPlaylist] = useState(true);\n  const [formatVideo, setFormatVideo] = useState(true);\n\n  const [showModal, setShowModal] = useState(false);\n\n  //const openModal = function() {\n    //setShowModal(true);\n  //}\n\n  const closeModal = function() {\n    setShowModal(false);\n  }\n\n  /*\n   * When the user initializes a login attempt.\n   */\n  const handleSubmit = async function() {\n    if(!query) {\n      return;\n    }\n    const responseJson = await fetchSearchMusicLibrary(\n      query,\n      serviceAppleMusic,\n      serviceSpotify,\n      serviceYouTube,\n      serviceJukeboxRadio,\n      formatTrack,\n      formatAlbum,\n      formatPlaylist,\n      formatVideo,\n    );\n    setSearchResults(responseJson.data);\n  }\n\n  /*\n   * When...\n   */\n  const addToQueue = async function(className, genericUuid) {\n    await fetchCreateQueue(\n      className,\n      genericUuid,\n    );\n\n    const responseJsonQueueList = await fetchQueueList();\n    props.dispatch(responseJsonQueueList.redux);\n  }\n\n  /*\n   *\n   */\n  const handleKeyDown = (event) => {\n   if (event.key === 'Enter') {\n     handleSubmit();\n   }\n }\n\n  return (\n    <div>\n      <div className={styles.SearchApp}>\n\n        <label>\n          &nbsp;\n          <input type=\"text\"\n                 name=\"query\"\n                 placeholder=\"\"\n                 className={styles.SearchBar}\n                 value={query}\n                 onChange={(e) => {setQuery(e.target.value)}}\n                 onKeyDown={handleKeyDown} />\n        </label>\n\n        <br></br>\n\n        <div className={styles.FormBlock}>\n          <label>\n            <input type=\"checkbox\"\n                   checked={serviceAppleMusic}\n                   onChange={(e) => {setServiceAppleMusic(e.target.checked)}} />\n            Apple Music\n          </label>\n\n          <label>\n            <input type=\"checkbox\"\n                   checked={serviceSpotify}\n                   onChange={(e) => {setServiceSpotify(e.target.checked)}} />\n            Spotify\n          </label>\n\n          <label>\n            <input type=\"checkbox\"\n                   name=\"provider.youTube\"\n                   checked={serviceYouTube}\n                   onChange={(e) => {setServiceYouTube(e.target.checked)}} />\n            YouTube\n          </label>\n\n          <label>\n            <input type=\"checkbox\"\n                   name=\"provider.jukeboxRadio\"\n                   checked={serviceJukeboxRadio}\n                   onChange={(e) => {setServiceJukeboxRadio(e.target.checked)}} />\n            Jukebox Radio\n          </label>\n        </div>\n\n        <div className={styles.FormBlock}>\n          <label>\n            <input type=\"checkbox\"\n                   checked={formatTrack}\n                   onChange={(e) => {setFormatTrack(e.target.checked)}} />\n            Track\n          </label>\n\n          <label>\n            <input type=\"checkbox\"\n                   checked={formatAlbum}\n                   onChange={(e) => {setFormatAlbum(e.target.checked)}} />\n            Album\n          </label>\n\n          <label>\n            <input type=\"checkbox\"\n                   checked={formatPlaylist}\n                   onChange={(e) => {setFormatPlaylist(e.target.checked)}} />\n            Playlist\n          </label>\n\n          <label>\n            <input type=\"checkbox\"\n                   checked={formatVideo}\n                   onChange={(e) => {setFormatVideo(e.target.checked)}} />\n            Video\n          </label>\n        </div>\n\n        <br></br>\n\n        <div className={styles.FormBlock}\n             onClick={handleSubmit}>\n          <button type=\"submit\">\n            Search\n          </button>\n        </div>\n      </div>\n\n      <br></br>\n\n      <div className={styles.SearchResults}>\n        {searchResults.map((value, index) => (\n          <SearchResult key={value.uuid} data={value} addToQueue={addToQueue}></SearchResult>\n        ))}\n      </div>\n\n      <Upload isOpen={showModal}\n              closeModal={closeModal} />\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({});\n\n\nexport default connect(mapStateToProps)(SearchApp);\n","export const iconPlug = (\n  <svg\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M9 2C8.44771 2 8 2.44772 8 3V5C8 5.55228 8.44771 6 9 6C9.55229 6 10 5.55228 10 5V3C10 2.44772 9.55229 2 9 2ZM8 9H16V11C16 13.2091 14.2091 15 12 15C9.79086 15 8 13.2091 8 11V9ZM13 16.917C15.8377 16.441 18 13.973 18 11V7H6V11C6 13.973 8.16229 16.441 11 16.917V22C11 22.5523 11.4477 23 12 23C12.5523 23 13 22.5523 13 22V16.917ZM14 3C14 2.44772 14.4477 2 15 2C15.5523 2 16 2.44772 16 3V5C16 5.55228 15.5523 6 15 6C14.4477 6 14 5.55228 14 5V3Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n)\n","import React from \"react\";\nimport { connect } from 'react-redux';\nimport Modal from 'react-modal';\nimport { useHistory } from \"react-router-dom\";\nimport styles from './WelcomeApp.module.css';\nimport { iconPlug } from './icons';\n\n\nfunction WelcomeApp(props) {\n\n  const history = useHistory();\n\n  const userSettings = props.userSettings,\n        playback = props.playback;\n\n  const isOpen = props.isOpen,\n        closeModal = props.closeModal;\n\n  const handleAppleMusic = function() {\n    const music = window.MusicKit.getInstance();\n    if(!music.musicUserToken) {\n      playback.appleMusic.api.authorize();\n    } else {\n      history.push(\"/app/search\");\n      closeModal();\n    }\n  }\n\n  const handleSpotify = function () {\n    if(userSettings && !userSettings.spotify.accessToken) {\n      window.location.href = props.userSettings.spotify.authorizationUrl;\n    } else {\n      history.push(\"/app/search\");\n    }\n    closeModal();\n  }\n\n  const handleYouTube = function () {\n    history.push(\"/app/search\");\n    closeModal();\n  }\n\n  const handleLibrary = function () {\n    history.push(\"/app/search\");\n    closeModal();\n  }\n\n   /*\n    * \n    */\n  return (\n    <Modal isOpen={isOpen}\n           ariaHideApp={false}>\n      <div className={styles.WelcomeApp}>\n        <button onClick={closeModal}>\n          Close\n        </button>\n        <h2>Welcome</h2>\n        <p>Where do you want to start?</p>\n\n        <button className={styles.Button}\n                onClick={handleAppleMusic}\n                disabled={!playback.appleMusic.api}>\n          {playback.appleMusic.api && !playback.appleMusic.api?.musicUserToken && iconPlug}\n          Apple Music\n        </button>\n        &nbsp;&nbsp;&nbsp;&nbsp;\n\n        <button className={styles.Button}\n                onClick={handleSpotify}\n                disabled={!userSettings}>\n          {userSettings && !userSettings.spotify.accessToken && iconPlug}\n          Spotify\n        </button>\n        &nbsp;&nbsp;&nbsp;&nbsp;\n\n        <button className={styles.Button}\n                onClick={handleYouTube}>\n          YouTube\n        </button>\n        &nbsp;&nbsp;&nbsp;&nbsp;\n\n        <button className={styles.Button}\n                onClick={handleLibrary}>\n          Library\n        </button>\n      </div>\n    </Modal>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n  userSettings: state.userSettings,\n  playback: state.playback,\n});\n\n\nexport default connect(mapStateToProps)(WelcomeApp);\n","import React from \"react\";\nimport styles from './ChildProgressBar.module.css';\n\n\nfunction ChildProgressBar(props) {\n\n  const interval = props.interval,\n        // TODO: for now, everything inside here will be either all or mute.\n        //       in the future, we need to add more styles for the other purposes.\n        purpose = interval.purpose === 'mute' ? 'mute' : 'all';\n\n  const duration = props.duration,\n        intervalWidthDuration = interval.endPosition - interval.startPosition,\n        intervalWidthStyle = (\n          intervalWidthDuration / duration * 400 + \"px\"\n        );\n\n  const cleanedPurpose = purpose.charAt(0).toUpperCase() + purpose.slice(1),\n        progressClass = \"Progress\" + cleanedPurpose,\n        classNames = [];\n\n  classNames.push(styles[progressClass]);\n  if(interval.startPosition === 0) {\n    classNames.push(styles.FirstInterval);\n  }\n  if(interval.endPosition === duration) {\n    classNames.push(styles.LastInterval);\n  }\n\n  return (\n    <div className={purpose === \"all\" ? styles.ProgressParentMuted : styles.ProgressParentBare}>\n      <div className={classNames.join(' ')}\n           style={{width: intervalWidthStyle}}>\n      </div>\n    </div>\n  );\n}\n\n\nexport default ChildProgressBar;\n","export const iconNextTrack = (\n  <svg\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path d=\"M6 17L14 12L6 7V17Z\" fill=\"currentColor\" />\n    <path d=\"M18 7H15V12V17H18V7Z\" fill=\"currentColor\" />\n  </svg>\n);\n\n\nexport const iconPrevTrack = (\n  <svg\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path d=\"M18 17L10 12L18 7V17Z\" fill=\"currentColor\" />\n    <path d=\"M6 7H9V17H6V7Z\" fill=\"currentColor\" />\n  </svg>\n)\n\n\n\nexport const iconUpTriangle = (\n  <svg width=\"22\" height=\"18\" viewBox=\"0 0 22 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path d=\"M11 1.04907e-06L21.3923 17.25L0.607694 17.25L11 1.04907e-06Z\" fill=\"#5BC9EC\"/>\n  </svg>\n)\n\n\nexport const iconDownTriangle = (\n  <svg width=\"22\" height=\"18\" viewBox=\"0 0 22 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path d=\"M11 18L21.3923 0.75L0.607696 0.749998L11 18Z\" fill=\"#5BC9EC\"/>\n  </svg>\n)\n","import React, { useState, useEffect } from \"react\";\nimport { connect } from 'react-redux';\nimport styles from './ParentProgressBar.module.css';\nimport { getPositionMilliseconds } from '../utils';\nimport ChildProgressBar from '../ChildProgressBar/ChildProgressBar';\nimport { getAllIntervals } from './utils';\nimport { iconDownTriangle } from '../icons';\n\n\nfunction ParentProgressBar(props) {\n\n  const queue = props.queue,\n        allIntervals = getAllIntervals(queue);\n\n  const stream = props.stream,\n        duration = stream.nowPlaying?.track?.durationMilliseconds || 0,\n        arr = getPositionMilliseconds(stream, stream.startedAt),\n        position = arr[0];\n\n  const pointerLeftDistance = (position / duration) * 400 + \"px\";\n\n  //////////////////////////////////////////////////////////////////////////////\n  // REGENERATE THE FEED\n  // eslint-disable-next-line\n  const [counter, setCounter] = useState(0);\n  useEffect(() => {\n\n    const periodicTask = setInterval(() => {\n      setCounter(prev => prev + 1);\n    }, 50);\n\n    return () => {\n      clearInterval(periodicTask);\n    }\n\n  // eslint-disable-next-line\n  }, []);\n\n  return (\n    <div className={styles.ParentProgressBar}>\n      <div className={styles.ProgressPointer}\n           style={{left: pointerLeftDistance}}>\n        {iconDownTriangle}\n      </div>\n      <div className={styles.ProgressBar}>\n        {  // eslint-disable-next-line\n        allIntervals.map((interval, index) => {\n          return <ChildProgressBar key={index}\n                                   interval={interval}\n                                   duration={duration}>\n                 </ChildProgressBar>;\n        })}\n      </div>\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n    stream: state.stream,\n});\n\n\nexport default connect(mapStateToProps)(ParentProgressBar);\n","export const getAllIntervals = function(queue) {\n  const playbackIntervals = queue?.playbackIntervals,\n        allIntervals = [];\n\n  if(!playbackIntervals?.length) {\n    return allIntervals;\n  }\n\n  let lastVal;\n  for(let interval of playbackIntervals) {\n    if(lastVal && lastVal !== interval.startPosition) {\n      allIntervals.push({\n        startPosition: lastVal,\n        endPosition: interval.startPosition,\n        purpose: \"mute\",\n      });\n    }\n    allIntervals.push(interval);\n    lastVal = interval.endPosition;\n  }\n\n  const firstIntervalStart = allIntervals[0].startPosition;\n  if(firstIntervalStart !== 0) {\n    allIntervals.unshift({\n      startPosition: 0,\n      endPosition: firstIntervalStart,\n      purpose: \"mute\",\n    });\n  }\n\n  const lastIntervalEnd = allIntervals[allIntervals.length - 1].endPosition,\n        nowPlayingTrackDuration = queue.track.durationMilliseconds;\n  if(lastIntervalEnd !== nowPlayingTrackDuration) {\n    allIntervals.push({\n      startPosition: lastIntervalEnd,\n      endPosition: nowPlayingTrackDuration,\n      purpose: \"mute\",\n    });\n  }\n\n  return allIntervals;\n}\n","import { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { connect } from 'react-redux';\nimport {\n  getNextUpQueue,\n  getLastUpQueue,\n} from '../../../components/QueueApp/utils';\nimport ParentProgressBar from '../ParentProgressBar/ParentProgressBar';\nimport { iconNextTrack, iconPrevTrack } from '../icons';\nimport styles from './Player.module.css';\n\n\nfunction Player(props) {\n\n  /*\n   * \n   */\n  const stream = props.stream,\n        playback = props.playback,\n        imageUrl = stream.nowPlaying?.track?.imageUrl,\n        track = stream?.nowPlaying?.track,\n        lastUp = getLastUpQueue(props.lastUpQueues),\n        nextUp = getNextUpQueue(props.nextUpQueues);\n\n  // NOTE: This is a temporary mechanism to allow the user to refresh the\n  //       progress value on the front-end.\n  // eslint-disable-next-line\n  const [counter, setCounter] = useState(0);\n\n  const handleRefreshProgress = function() {\n    setCounter(prev => prev + 1);\n  }\n\n  // BUG: Edge case needed to refresh the webpage. In the future, there should\n  //      be an API endpoint to fetch additional past queue items.\n  if(stream?.nowPlaying?.index !== 1 && !lastUp) {\n    window.location.reload();\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  // RELOAD PROGRESS BAR\n  useEffect(() => {\n    const periodicTask = setInterval(() => {\n      handleRefreshProgress();\n    }, 100);\n\n    return () => {\n      clearInterval(periodicTask);\n    }\n  // eslint-disable-next-line\n  }, []);\n\n  return (\n    <div className={styles.Player}>\n      <div className={styles.Div}>\n        <h4><i>Last...</i></h4>\n        <p>{lastUp?.track?.name}</p>\n      </div>\n\n      <br></br>\n\n      <div className={styles.Div}>\n        <h2><i>Now playing...</i></h2>\n        {imageUrl &&\n          <img alt=\"\"\n               src={imageUrl}\n               className={styles.Image} />\n        }\n        {(stream?.isPlaying || stream?.isPaused) &&\n          <h3>{track?.name}</h3>\n        }\n        {(!stream?.isPlaying && !stream?.isPaused) &&\n          <h3><i>Waiting...</i></h3>\n        }\n      </div>\n\n      <div className={styles.Div}>\n        <ParentProgressBar queue={stream?.nowPlaying}></ParentProgressBar>\n      </div>\n\n      <div className={styles.Div}>\n        <button className={styles.Button}\n                onClick={props.prevTrack}\n                disabled={!playback.controlsEnabled}>\n          {iconPrevTrack}\n        </button>\n        <button className={styles.Button}\n                onClick={props.nextTrack}\n                disabled={!playback.controlsEnabled}>\n          {iconNextTrack}\n        </button>\n      </div>\n\n      <br></br>\n\n      <div className={styles.Div}>\n        <h4><i>Next...</i></h4>\n        <p>{nextUp?.track.name}</p>\n      </div>\n\n      <Link to=\"/app/queue\">\n        <button className={styles.MoreNextUp}>\n          More\n        </button>\n      </Link>\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n    stream: state.stream,\n    lastUpQueues: state.lastUpQueues,\n    nextUpQueues: state.nextUpQueues,\n    playback: state.playback,\n});\n\n\nexport default connect(mapStateToProps)(Player);\n","import React from \"react\";\nimport { connect } from 'react-redux';\nimport styles from './MiniPlayer.module.css';\n\n\nfunction MiniPlayer(props) {\n\n  const stream = props.stream,\n        imageUrl = stream.nowPlaying?.track?.imageUrl,\n        nowPlayingTrackName = stream?.nowPlaying?.track?.name;\n\n  return (\n    <div>\n      <h3><i>Now playing...</i></h3>\n      {imageUrl &&\n        <img alt=\"\"\n             src={imageUrl}\n             className={styles.Image} />\n      }\n      {nowPlayingTrackName ?\n        (\n          <p>{nowPlayingTrackName}</p>\n        ) : (\n          <p><i>Nothing is playing...</i></p>\n        )\n      }\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n    stream: state.stream,\n});\n\n\nexport default connect(mapStateToProps)(MiniPlayer);\n","export const iconScanForward = (\n<svg xmlns=\"http://www.w3.org/2000/svg\" enableBackground=\"new 0 0 24 24\" height=\"48px\" viewBox=\"0 0 24 24\" width=\"48px\" fill=\"#000000\"><g><rect fill=\"none\" height=\"48\" width=\"48\"/><rect fill=\"none\" height=\"48\" width=\"48\"/><rect fill=\"none\" height=\"48\" width=\"48\"/></g><g><g/><g><path d=\"M18,13c0,3.31-2.69,6-6,6s-6-2.69-6-6s2.69-6,6-6v4l5-5l-5-5v4c-4.42,0-8,3.58-8,8c0,4.42,3.58,8,8,8s8-3.58,8-8H18z\"/><polygon points=\"10.9,16 10.9,11.73 10.81,11.73 9.04,12.36 9.04,13.05 10.05,12.74 10.05,16\"/><path d=\"M14.32,11.78c-0.18-0.07-0.37-0.1-0.59-0.1s-0.41,0.03-0.59,0.1s-0.33,0.18-0.45,0.33s-0.23,0.34-0.29,0.57 s-0.1,0.5-0.1,0.82v0.74c0,0.32,0.04,0.6,0.11,0.82s0.17,0.42,0.3,0.57s0.28,0.26,0.46,0.33s0.37,0.1,0.59,0.1s0.41-0.03,0.59-0.1 s0.33-0.18,0.45-0.33s0.22-0.34,0.29-0.57s0.1-0.5,0.1-0.82V13.5c0-0.32-0.04-0.6-0.11-0.82s-0.17-0.42-0.3-0.57 S14.49,11.85,14.32,11.78z M14.33,14.35c0,0.19-0.01,0.35-0.04,0.48s-0.06,0.24-0.11,0.32s-0.11,0.14-0.19,0.17 s-0.16,0.05-0.25,0.05s-0.18-0.02-0.25-0.05s-0.14-0.09-0.19-0.17s-0.09-0.19-0.12-0.32s-0.04-0.29-0.04-0.48v-0.97 c0-0.19,0.01-0.35,0.04-0.48s0.06-0.23,0.12-0.31s0.11-0.14,0.19-0.17s0.16-0.05,0.25-0.05s0.18,0.02,0.25,0.05 s0.14,0.09,0.19,0.17s0.09,0.18,0.12,0.31s0.04,0.29,0.04,0.48V14.35z\"/></g></g></svg>\n);\n\n\nexport const iconScanBackward = (\n<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"48px\" viewBox=\"0 0 24 24\" width=\"48px\" fill=\"#000000\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M11.99 5V1l-5 5 5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6h-2c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8zm-1.1 11h-.85v-3.26l-1.01.31v-.69l1.77-.63h.09V16zm4.28-1.76c0 .32-.03.6-.1.82s-.17.42-.29.57-.28.26-.45.33-.37.1-.59.1-.41-.03-.59-.1-.33-.18-.46-.33-.23-.34-.3-.57-.11-.5-.11-.82v-.74c0-.32.03-.6.1-.82s.17-.42.29-.57.28-.26.45-.33.37-.1.59-.1.41.03.59.1.33.18.46.33.23.34.3.57.11.5.11.82v.74zm-.85-.86c0-.19-.01-.35-.04-.48s-.07-.23-.12-.31-.11-.14-.19-.17-.16-.05-.25-.05-.18.02-.25.05-.14.09-.19.17-.09.18-.12.31-.04.29-.04.48v.97c0 .19.01.35.04.48s.07.24.12.32.11.14.19.17.16.05.25.05.18-.02.25-.05.14-.09.19-.17.09-.19.11-.32.04-.29.04-.48v-.97z\"/></svg>\n);\n\n\nexport const iconPlayCircle = (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"48px\" viewBox=\"0 0 24 24\" width=\"48px\" fill=\"#000000\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M10 16.5l6-4.5-6-4.5zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"/></svg>\n);\n\n\nexport const iconPauseCircle = (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" enableBackground=\"new 0 0 24 24\" height=\"48px\" viewBox=\"0 0 24 24\" width=\"48px\" fill=\"#000000\"><g><rect fill=\"none\" height=\"24\" width=\"24\"/></g><g><g><path d=\"M9,16h2V8H9V16z M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8 s3.59-8,8-8s8,3.59,8,8S16.41,20,12,20z M13,16h2V8h-2V16z\"/></g></g></svg>\n);\n\n\nexport const iconNotStartedCircle = (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" enableBackground=\"new 0 0 24 24\" height=\"48px\" viewBox=\"0 0 24 24\" width=\"48px\" fill=\"#000000\"><g><rect fill=\"none\" height=\"24\" width=\"24\"/><path d=\"M12,4c4.41,0,8,3.59,8,8s-3.59,8-8,8s-8-3.59-8-8S7.59,4,12,4 M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10 s10-4.48,10-10C22,6.48,17.52,2,12,2L12,2z M11,8H9v8h2V8z M17,12l-5-4v8L17,12z\"/></g></svg>\n)\n\n\nexport const iconMusic = (\n  <svg\n    width=\"28\"\n    height=\"28\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M12 8.95439L17.6352 7.82736C19.0102 7.55235 20 6.34501 20 4.94274C20 3.08637 18.3017 1.69406 16.4813 2.05813L12.4117 2.87206C11.0094 3.15252 10 4.38376 10 5.8138V13.8895C9.41165 13.5492 8.72857 13.3544 8 13.3544C5.79086 13.3544 4 15.1453 4 17.3544C4 19.5635 5.79086 21.3544 8 21.3544C10.2091 21.3544 12 19.5635 12 17.3544V8.95439ZM16.8736 4.01929L12.8039 4.83322C12.3365 4.92671 12 5.33712 12 5.8138V6.91479L17.2429 5.8662C17.6831 5.77816 18 5.39165 18 4.94274C18 4.34846 17.4563 3.90274 16.8736 4.01929ZM10 17.3544C10 16.2498 9.10457 15.3544 8 15.3544C6.89543 15.3544 6 16.2498 6 17.3544C6 18.459 6.89543 19.3544 8 19.3544C9.10457 19.3544 10 18.459 10 17.3544Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n)\n\n\nexport const iconMic = (\n  <svg\n    width=\"26\"\n    height=\"26\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M9 4C9 2.34315 10.3431 1 12 1C13.6569 1 15 2.34315 15 4V12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12V4ZM13 4V12C13 12.5523 12.5523 13 12 13C11.4477 13 11 12.5523 11 12V4C11 3.44772 11.4477 3 12 3C12.5523 3 13 3.44772 13 4Z\"\n      fill=\"currentColor\"\n    />\n    <path\n      d=\"M18 12C18 14.973 15.8377 17.441 13 17.917V21H17V23H7V21H11V17.917C8.16229 17.441 6 14.973 6 12V9H8V12C8 14.2091 9.79086 16 12 16C14.2091 16 16 14.2091 16 12V9H18V12Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n)\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { connect } from 'react-redux';\nimport { CircularProgressbarWithChildren, buildStyles } from 'react-circular-progressbar';\nimport 'react-circular-progressbar/dist/styles.css';\nimport { cycleVolumeLevel } from '../../PlaybackApp/utils';\nimport { playbackChangeVolume } from '../../PlaybackApp/controls';\nimport styles from './BottomBar.module.css';\nimport {\n  iconScanForward,\n  iconScanBackward,\n  iconPlayCircle,\n  iconPauseCircle,\n  iconMusic,\n  // iconMic,\n} from './icons';\n\n\nfunction BottomBar(props) {\n\n  /*\n   * \n   */\n  const playbackControls = props.playbackControls,\n        stream = props.stream,\n        playback = props.playback,\n        audioVolumeLevel = playback.volumeLevel.audio,\n        nextUpQueues = props.nextUpQueues;\n\n  const scanDisabled = (\n          !stream.nowPlaying ||\n          stream.isPaused ||\n          !playback.controlsEnabled\n        ),\n        playPauseDisabled = (\n          !stream.nowPlaying ||\n          !playback.controlsEnabled\n        );\n\n  const displayStartPlayback = !stream.nowPlaying && !!nextUpQueues.length,\n        displayAddToQueue = !stream.nowPlaying && !nextUpQueues.length;\n\n  /*\n   * Modify playback to play whatever is next in the queue.\n   */\n  const handleStartPlayback = function() {\n    playbackControls.nextTrack();\n  };\n\n  /*\n   * Modify playback to seek in a certain diretion ('forward' or 'backward').\n   */\n  const handleSeek = function(direction) {\n    if(scanDisabled) {\n      return;\n    }\n    playbackControls.seek(direction);\n  };\n\n  /*\n   * Modify playback to play or pause, whichever one is relevant.\n   */\n  const handlePlayPause = function() {\n    if(playPauseDisabled) {\n      return;\n    }\n    if(stream.isPlaying) {\n      playbackControls.pause();\n    }\n    if(stream.isPaused) {\n      playbackControls.play();\n    }\n  }\n\n  const handleCycleVolumeLevel = function() {\n    const nextVolumeLevel = cycleVolumeLevel(audioVolumeLevel);\n    playbackChangeVolume(playback, stream, nextVolumeLevel);\n    props.dispatch({ type: 'playback/cycleVolumeLevelAudio' });\n  }\n\n  /*\n   * \n   */\n  return (\n    <div className={styles.BottomBar}>\n\n      <div className={styles.ExtraControl}>\n        {displayStartPlayback && (\n          <button className={styles.ExtraControlButton}\n                  onClick={() => { handleStartPlayback(); }}>\n            Start Playback\n          </button>\n        )}\n        {displayAddToQueue && (\n          <Link to=\"/app/search\">\n            <button className={styles.ExtraControlButton}>\n              Add to Queue\n            </button>\n          </Link>\n        )}\n      </div>\n\n      <div className={styles.Volume}>\n        <button className={styles.VolumeButton}\n                onClick={handleCycleVolumeLevel}>\n          <CircularProgressbarWithChildren\n                value={audioVolumeLevel * 100}\n                circleRatio={0.75}\n                styles={buildStyles({\n                  rotation: 1 / 2 + 1 / 8,\n                  strokeLinecap: \"butt\",\n                  trailColor: \"#eee\",\n                })} >\n            {iconMusic}\n          </CircularProgressbarWithChildren>\n        </button>\n\n        {/*\n        <div className={styles.VolumeButton}>\n          <CircularProgressbarWithChildren\n                value={100}\n                circleRatio={0.75}\n                styles={buildStyles({\n                  rotation: 1 / 2 + 1 / 8,\n                  strokeLinecap: \"butt\",\n                  trailColor: \"#eee\",\n                })} >\n            {iconMic}\n          </CircularProgressbarWithChildren>\n        </div>\n        */}\n      </div>\n\n      <div className={styles.Playback}>\n        <button className={styles.PlaybackButton}\n                onClick={() => { handleSeek('backward'); }}\n                disabled={scanDisabled} >\n          {iconScanBackward}\n        </button>\n        <button className={styles.PlaybackButton}\n                onClick={() => { handlePlayPause(); }}\n                disabled={playPauseDisabled} >\n          {stream.nowPlaying && stream.isPlaying ?\n            iconPauseCircle : iconPlayCircle\n          }\n        </button>\n        <button className={styles.PlaybackButton}\n                onClick={() => { handleSeek('forward'); }}\n                disabled={scanDisabled} >\n          {iconScanForward}\n        </button>\n      </div>\n\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n    stream: state.stream,\n    playback: state.playback,\n    nextUpQueues: state.nextUpQueues,\n});\n\n\nexport default connect(mapStateToProps)(BottomBar);\n","import React, { useState } from \"react\";\nimport Modal from 'react-modal';\nimport { connect } from 'react-redux';\nimport { fetchUpdateUserSettings } from './network';\n\n\nfunction UserSettings(props) {\n\n  /*\n   * \n   */\n  const isOpen = props.isOpen,\n        closeModal = props.closeModal;\n\n  // TODO actually impliment the disabled behavior\n  // eslint-disable-next-line\n  const [controlsEnabled, setControlsEnabled] = useState(true);\n\n  if (!props.userSettings) {\n    return <></>;\n  }\n\n  function updateIdleQueue(event) {\n    props.dispatch({type: 'userSettings/update', payload:{\n      idleQueue: event.target.checked\n    }});\n    fetchUpdateUserSettings('idle_after_now_playing', event.target.checked);\n  }\n\n  function updateSpeakVoice(event) {\n    props.dispatch({type: 'userSettings/update', payload:{\n      speakVoice: event.target.checked\n    }})\n    fetchUpdateUserSettings('mute_voice_recordings', event.target.checked);\n  }\n\n  function updateFocusMode(event) {\n    props.dispatch({type: 'userSettings/update', payload:{\n      focusMode: event.target.checked\n    }})\n    fetchUpdateUserSettings('focus_mode', event.target.checked);\n  }\n\n  return (\n    <Modal isOpen={isOpen}\n           ariaHideApp={false}>\n      <button onClick={closeModal}>Close</button>\n\n      <br></br><br></br>\n\n      <div>\n        <a href={props.userSettings.spotify.authorizationUrl}>Connect Your Spotify Account</a>\n\n        <br></br><br></br>\n\n        <div>\n          <label>\n            <input type=\"checkbox\" checked={props.userSettings.idleQueue} onChange={updateIdleQueue} disabled={!controlsEnabled}/>\n            Idle After Queue\n          </label><br/>\n          <label>\n            <input type=\"checkbox\" checked={props.userSettings.speakVoice} onChange={updateSpeakVoice} disabled={!controlsEnabled}/>\n            Speak Voice Recordings\n          </label><br/>\n          <label>\n            <input type=\"checkbox\" checked={props.userSettings.focusMode} onChange={updateFocusMode} disabled={!controlsEnabled}/>\n            Focus Mode\n          </label><br/>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  userSettings: state.userSettings\n});\n\nexport default connect(mapStateToProps)(UserSettings);\n","export const iconProfile = (\n  <svg\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M16 9C16 11.2091 14.2091 13 12 13C9.79086 13 8 11.2091 8 9C8 6.79086 9.79086 5 12 5C14.2091 5 16 6.79086 16 9ZM14 9C14 10.1046 13.1046 11 12 11C10.8954 11 10 10.1046 10 9C10 7.89543 10.8954 7 12 7C13.1046 7 14 7.89543 14 9Z\"\n      fill=\"currentColor\"\n    />\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M12 1C5.92487 1 1 5.92487 1 12C1 18.0751 5.92487 23 12 23C18.0751 23 23 18.0751 23 12C23 5.92487 18.0751 1 12 1ZM3 12C3 14.0902 3.71255 16.014 4.90798 17.5417C6.55245 15.3889 9.14627 14 12.0645 14C14.9448 14 17.5092 15.3531 19.1565 17.4583C20.313 15.9443 21 14.0524 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12ZM12 21C9.84977 21 7.87565 20.2459 6.32767 18.9878C7.59352 17.1812 9.69106 16 12.0645 16C14.4084 16 16.4833 17.1521 17.7538 18.9209C16.1939 20.2191 14.1881 21 12 21Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n);\n\n\nexport const iconMore = (\n  <svg\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M5 15C6.65685 15 8 13.6569 8 12C8 10.3431 6.65685 9 5 9C3.34315 9 2 10.3431 2 12C2 13.6569 3.34315 15 5 15ZM5 13C5.55228 13 6 12.5523 6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12C4 12.5523 4.44772 13 5 13Z\"\n      fill=\"currentColor\"\n    />\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15ZM12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13Z\"\n      fill=\"currentColor\"\n    />\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M22 12C22 13.6569 20.6569 15 19 15C17.3431 15 16 13.6569 16 12C16 10.3431 17.3431 9 19 9C20.6569 9 22 10.3431 22 12ZM20 12C20 12.5523 19.5523 13 19 13C18.4477 13 18 12.5523 18 12C18 11.4477 18.4477 11 19 11C19.5523 11 20 11.4477 20 12Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n);\n","import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport UserSettings from '../../UserSettings/UserSettings'\nimport styles from './SideBar.module.css';\nimport { iconProfile, iconMore } from './icons';\n\n\nfunction SideBar(props) {\n\n  /*\n   * \n   */\n  const [showModal, setShowModal] = useState(false);\n\n  const openModal = function() {\n    setShowModal(true);\n  }\n\n  const closeModal = function() {\n    setShowModal(false);\n  }\n\n   /*\n    * \n    */\n  return (\n    <div className={styles.SideBar}>\n\n      <br></br>\n\n      <div className={styles.Logo}>\n        {iconProfile}\n      </div>\n      <div className={styles.Jb}>\n        Jukebox Radio\n      </div>\n\n      <ul className={styles.Menu}>\n        <li className={styles.Search}>\n          <Link to=\"/app/search\">Search</Link>\n        </li>\n        <li className={styles.Queue}>\n          <Link to=\"/app/queue\">Queue</Link>\n        </li>\n        <li className={styles.Player}>\n          <Link to=\"/app/player\">Player</Link>\n        </li>\n        <li className={styles.Feed}>\n          <Link to=\"/app/feed\">Feed</Link>\n        </li>\n      </ul>\n\n      <div className={styles.Settings}>\n        <button onClick={openModal}>\n          {iconMore}\n        </button>\n      </div>\n\n      <UserSettings isOpen={showModal}\n                    closeModal={closeModal} />\n\n    </div>\n  );\n}\n\nexport default SideBar;\n","import React, { useState, useEffect } from \"react\";\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport { connect } from 'react-redux';\nimport styles from './Session.module.css';\n\nimport FeedApp from '../../FeedApp/FeedApp';\nimport MiniFeed from '../../FeedApp/MiniFeed/MiniFeed';\nimport QueueApp from '../../QueueApp/QueueApp';\nimport MiniQueue from '../../QueueApp/MiniQueue/MiniQueue';\nimport SearchApp from '../../SearchApp/SearchApp';\nimport WelcomeApp from '../../WelcomeApp/WelcomeApp';\nimport Player from '../../PlaybackApp/Player/Player';\nimport MiniPlayer from '../../PlaybackApp/MiniPlayer/MiniPlayer';\n\nimport BottomBar from '../BottomBar/BottomBar';\nimport SideBar from '../SideBar/SideBar';\n\n\nfunction Session(props) {\n\n  /*\n   * \n   */\n  const stream = props.stream,\n        nextUpQueues = props.nextUpQueues;\n\n  const [showModal, setShowModal] = useState(false);\n  const [forceHideModal, setForceHideModal] = useState(false);\n\n  const closeModal = function() {\n    setShowModal(false);\n  }\n\n  useEffect(() => {\n    const shouldDisplayModal = (\n      !stream.isPlaying &&\n      !stream.isPaused &&\n      !nextUpQueues.length &&\n      !forceHideModal\n    )\n    if(!shouldDisplayModal) {\n      return;\n    }\n    setShowModal(true);\n    setForceHideModal(true);\n  }, [stream, nextUpQueues, forceHideModal])\n\n   /*\n    * \n    */\n  return (\n    <div className={styles.Session}>\n\n      <WelcomeApp isOpen={showModal}\n                  closeModal={closeModal} />\n\n      <div className={styles.Top}>\n        <SideBar />\n\n        <div className={styles.Content}>\n\n        <Switch>\n          {/* FEED */}\n          <Route path=\"/app/feed\">\n            <div className={styles.PrimaryContent}>\n              <FeedApp />\n            </div>\n          </Route>\n          {/* PLAYER */}\n          <Route path=\"/app/player\">\n            <div className={styles.PrimaryContent}>\n              <Player nextTrack={props.playbackControls.nextTrack}\n                      prevTrack={props.playbackControls.prevTrack}\n                      seek={props.playbackControls.seek}\n                      pause={props.playbackControls.pause}\n                      play={props.playbackControls.play} />\n            </div>\n            <div className={styles.SecondaryContent}>\n              <Link to=\"/app/feed\">\n                <MiniFeed />\n              </Link>\n            </div>\n          </Route>\n          {/* QUEUE */}\n          <Route path=\"/app/queue\">\n            <div className={styles.PrimaryContent}>\n              <QueueApp />\n            </div>\n            <div className={styles.SecondaryContent}>\n              <Link to=\"/app/player\">\n                <MiniPlayer />\n              </Link>\n            </div>\n          </Route>\n          {/* SEARCH */}\n          <Route path=\"/app/search\">\n            <div className={styles.PrimaryContent}>\n              <SearchApp />\n            </div>\n            <div className={styles.SecondaryContent}>\n            <Link to=\"/app/queue\">\n              <MiniQueue />\n            </Link>\n            </div>\n          </Route>\n        </Switch>\n\n        </div>\n      </div>\n      <BottomBar playbackControls={props.playbackControls} />\n\n    </div>\n  );\n}\n\n\nconst mapStateToProps = (state) => ({\n    stream: state.stream,\n    nextUpQueues: state.nextUpQueues,\n});\n\n\nexport default connect(mapStateToProps)(Session);\n","import React from \"react\";\nimport { Switch, Route } from \"react-router-dom\";\n\nimport SpotifySync from '../SpotifySync/SpotifySync';\n\nimport Session from './Session/Session';\n\n\nfunction MainApp(props) {\n\n  /*\n   * \n   */\n  return (\n\n    <Switch>\n      <Route path=\"/app/:content\">\n        <Session playbackControls={props.playbackControls} />\n      </Route>\n      <Route path=\"/u/:username\">\n        <span>PROFILE</span>\n      </Route>\n      <Route path=\"/spotify\">\n        <SpotifySync />\n      </Route>\n      <Route>\n        <Session playbackControls={props.playbackControls} />\n      </Route>\n    </Switch>\n  );\n}\n\n\nexport default MainApp;\n","import {\n  fetchTextCommentList,\n  fetchVoiceRecordingList,\n} from '../FeedApp/network';\n\nimport { store } from '../../utils/redux';\n\n\n/*\n * Load comments and voice recordings to update the feed.\n */\nexport const updateFeed = async function(trackUuid) {\n  const responseJsonTextCommentList = await fetchTextCommentList(trackUuid);\n  const responseJsonVoiceRecordingList = await fetchVoiceRecordingList(trackUuid);\n  store.dispatch(responseJsonTextCommentList.redux);\n  store.dispatch(responseJsonVoiceRecordingList.redux);\n};\n","import { useEffect, useState } from \"react\";\nimport { connect } from 'react-redux';\nimport YouTube from 'react-youtube';\n\nimport {\n  playbackControlStart,\n  playbackControlSeek,\n  playbackControlPause,\n  playbackControlPlay,\n  playbackControlSkipToNext,\n  playbackControlQueue,\n} from './controls';\nimport { fetchGetUserSettings } from '../UserSettings/network';\nimport { getPositionMilliseconds, updateSpotifyPlayer } from './utils';\n\nimport MainApp from '../MainApp/MainApp';\nimport {\n  fetchNextTrack,\n  fetchPrevTrack,\n  fetchScanBackward,\n  fetchScanForward,\n  fetchTrackGetFiles,\n  fetchPauseTrack,\n  fetchPlayTrack,\n} from './Player/network';\nimport { updateFeed } from '../FeedApp/utils';\nimport { getLastUpQueue, getNextUpQueue } from '../QueueApp/utils';\n\nimport {\n  SERVICE_JUKEBOX_RADIO,\n  SERVICE_SPOTIFY,\n  SERVICE_APPLE_MUSIC,\n  SERVICE_YOUTUBE,\n} from '../../config/services';\n\nconst SpotifyWebApi = require('spotify-web-api-js');\n\n\nfunction PlaybackApp(props) {\n\n  /*\n   * \n   */\n  const stream = props.stream,\n        playback = props.playback,\n        lastUp = getLastUpQueue(props.lastUpQueues),\n        nextUp = getNextUpQueue(props.nextUpQueues);\n\n  const [appleMusicSDKReady, setAppleMusicSDKReady] = useState(false);\n\n  const [spotifySDKReady, setSpotifySDKReady] = useState(false);\n  const [spotifySDKDeviceID, setSpotifySDKDeviceID] = useState(undefined);\n  const [spotifySDKInit, setSpotifySDKInit] = useState(false);\n\n  // const [spotifyIsPaused, setSpotifyIsPaused] = useState(false);\n  // const [spotifyIsPlaying, setSpotifyIsPlaying] = useState(false);\n\n  const [messageScheduleNextTrack, setMessageScheduleNextTrack] = useState(false);\n  const [plannedNextTrackTimeoutId, setPlannedNextTrackTimeoutId] = useState({});\n  const [nextTrackJson, setNextTrackJson] = useState({});\n\n  /*\n   * Loads the Spotify SDK.\n   */\n  const appendSpotifySDK = function() {\n    const script = document.createElement(\"script\");\n    script.src = \"https://sdk.scdn.co/spotify-player.js\";\n    script.async = true;\n    new Promise(resolve => {\n      if (window.Spotify) {\n        resolve();\n      } else {\n        window.onSpotifyWebPlaybackSDKReady = resolve;\n      }\n    })\n      .then(() => {\n        setSpotifySDKReady(true);\n      });\n    document.body.appendChild(script);\n  };\n\n  /*\n   * Loads the Spotify SDK.\n   */\n  const appendAppleMusicSDK = function() {\n    new Promise(resolve => {\n      const script = document.createElement(\"script\");\n      script.src = \"https://js-cdn.music.apple.com/musickit/v1/musickit.js\";\n      script.async = true;\n      script.onload = () => { resolve(); };\n      document.body.appendChild(script);\n    })\n      .then(() => {\n        setAppleMusicSDKReady(true);\n      });\n  };\n\n  /*\n   * When a track is changing from one to another, this boolean logic\n   * determines whether or not the currently playing item needs to be paused.\n   */\n  const shouldPauseOnTrackChange = function(nextPlayingQueue, isPlanned) {\n    const nowPlaying = stream.nowPlaying,\n          playbackIntervals = nowPlaying?.playbackIntervals,\n          lastPlaybackInterval = (playbackIntervals ?\n            playbackIntervals[playbackIntervals.length - 1] :\n            undefined\n          );\n    return (\n      // There must be something now playing.\n      nowPlaying?.track &&\n      (\n        // Everytime a manual upload is currently playing.\n        nowPlaying.track.service === SERVICE_JUKEBOX_RADIO ||\n        // Currently playing Spotify, nothing is up next.\n        (\n          nowPlaying.track.service === SERVICE_SPOTIFY &&\n          !nextPlayingQueue?.track\n        ) ||\n        // Currently playing Spotify, Spotify is not up next.\n        (\n          nowPlaying.track.service === SERVICE_SPOTIFY &&\n          nextPlayingQueue.track.service !== SERVICE_SPOTIFY &&\n          (\n            !isPlanned ||\n            (\n              lastPlaybackInterval.endPosition !== nowPlaying.totalDurationMilliseconds &&\n              isPlanned\n            )\n          )\n        ) ||\n        // Currently playing Apple Music, nothing is up next.\n        (\n          nowPlaying.track.service === SERVICE_APPLE_MUSIC &&\n          !nextPlayingQueue?.track\n        ) ||\n        // Currently playing Apple Music, Apple Music is not up next.\n        (\n          nowPlaying.track.service === SERVICE_APPLE_MUSIC &&\n          nextPlayingQueue?.track.service !== SERVICE_APPLE_MUSIC &&\n          (\n            !isPlanned ||\n            (\n              lastPlaybackInterval.endPosition !== nowPlaying.totalDurationMilliseconds &&\n              isPlanned\n            )\n          )\n        ) ||\n        // Currently playing YouTube, nothing is up next.\n        (\n          nowPlaying.track.service === SERVICE_YOUTUBE &&\n          !nextPlayingQueue?.track\n        ) ||\n        // Currently playing YouTube, YouTube is not up next.\n        (\n          nowPlaying.track.service === SERVICE_YOUTUBE &&\n          nextPlayingQueue.track.service !== SERVICE_YOUTUBE &&\n          (\n            !isPlanned ||\n            (\n              lastPlaybackInterval.endPosition !== nowPlaying.totalDurationMilliseconds &&\n              isPlanned\n            )\n          )\n        )\n      )\n    )\n  }\n\n  /*\n   * This starts the now playing track.\n   * NOTE: You may think of this as \"playing\" the track. However, \"play\" in\n   *       code references different behavior. \"Play\" is used for toggling the\n   *       current track from a \"paused\" state to \"play.\" \"Start\" explicitly\n   *       plays the track.\n   */\n  const start = function() {\n    if(!stream.nowPlaying?.track) {\n      return;\n    }\n    props.dispatch({ type: 'playback/started' });\n    playbackControlStart(playback, stream);\n  }\n\n  /*\n   * This adds the nextUp item in the queue to play next (add to queue). This\n   * happens ~5 seconds before the next item should play.\n   */\n  const addToQueue = async function() {\n\n    // disable the player UI (until plannedNextTrack happens)\n    await props.dispatch({ type: 'playback/disable' });\n\n    // update the back-end\n    const responseJsonNextTrack = await fetchNextTrack(\n      stream.nowPlaying?.totalDurationMilliseconds, true\n    );\n\n    // update the front-end later\n    setNextTrackJson(responseJsonNextTrack);\n\n    // add to queue\n    await props.dispatch({ type: 'playback/addToQueue' });\n\n    playbackControlQueue(playback, stream, nextUp);\n\n    // schedule \"next track\"\n    setMessageScheduleNextTrack(true);\n  }\n\n  /*\n   *  Triggered by a scheduled task, this plays the next track.\n   */\n  const plannedNextTrack = async function() {\n    if(shouldPauseOnTrackChange(nextUp, true)) {\n      playbackControlPause(playback, stream);\n    }\n    const queuedUp = playback.queuedUp;\n    if(queuedUp) {\n      playbackControlSkipToNext(playback, stream);\n    }\n    await props.dispatch({\n      type: 'playback/plannedNextTrack',\n      payload: { payload: nextTrackJson.redux },  // yes\n    });\n    await props.dispatch({ type: 'playback/enable' });\n    await updateFeed(nextUp?.track?.uuid);\n  }\n\n  /*\n   * Triggered by human interaction, this plays the previous track.\n   */\n  const prevTrack = async function() {\n    await props.dispatch({ type: 'playback/disable' });\n    if(shouldPauseOnTrackChange(lastUp, false)) {\n      playbackControlPause(playback, stream);\n    }\n    if(lastUp.track?.service === SERVICE_JUKEBOX_RADIO) {\n      const responseJson = await fetchTrackGetFiles(lastUp.track.uuid);\n      await props.dispatch(responseJson.redux);\n    }\n    const responseJsonPrevTrack = await fetchPrevTrack(stream.nowPlaying?.totalDurationMilliseconds);\n    await props.dispatch(responseJsonPrevTrack.redux);\n    await props.dispatch({ type: 'playback/start' });\n    await props.dispatch({ type: 'playback/enable' });\n    await updateFeed(lastUp?.track?.uuid);\n  }\n\n  /*\n   * Triggered by human interaction, this plays the next track.\n   */\n  const nextTrack = async function() {\n    await props.dispatch({ type: 'playback/disable' });\n    if(shouldPauseOnTrackChange(nextUp, false)) {\n      playbackControlPause(playback, stream);\n    }\n    if(nextUp?.track.service === SERVICE_JUKEBOX_RADIO) {\n      const responseJson = await fetchTrackGetFiles(nextUp.track.uuid);\n      await props.dispatch(responseJson.redux);\n    }\n    const responseJsonNextTrack = await fetchNextTrack(\n      stream.nowPlaying?.totalDurationMilliseconds, false\n    );\n    await props.dispatch(responseJsonNextTrack.redux);\n    await props.dispatch({ type: 'playback/start' });\n    await props.dispatch({ type: 'playback/enable' });\n    await updateFeed(nextUp?.track?.uuid);\n  }\n\n  /*\n   * Seek to the expected position in the track. This may be called in 3 cases:\n   *   1: a user signals the track to scan forward 10 seconds.\n   *   2: a user signals the track to scan backward 10 seconds.\n   *   3: a seekTimeout event is triggered, meaning the now playing track must\n   *      seek to the new expected track progress (in the case of a muted\n   *      interval).\n   */\n  const seek = async function(direction = undefined) {\n    await props.dispatch({ type: 'playback/disable' });\n    let startedAt;\n\n    if(direction === 'forward') {\n      const response = await fetchScanForward(\n        stream.nowPlaying.totalDurationMilliseconds\n      );\n      // Seeking forward is not allowed because the track is almost over.\n      if(response.system.status === 400) {\n        await props.dispatch({ type: 'playback/enable' });\n        return;\n      }\n      startedAt = stream.startedAt - (10000);\n    } else if(direction === 'backward') {\n      await fetchScanBackward(stream.nowPlaying.totalDurationMilliseconds);\n      const date = new Date(),\n            epochNow = date.getTime(),\n            proposedStartedAt = stream.startedAt + 10000,\n            proposedProgress = epochNow - proposedStartedAt;\n      startedAt = proposedProgress > 0 ? proposedStartedAt : epochNow;\n    } else {\n      startedAt = stream.startedAt;\n    }\n\n    await props.dispatch({\n      type: 'stream/set',\n      payload: {stream: { ...stream, startedAt: startedAt }},\n    });\n\n    const arr = getPositionMilliseconds(stream, startedAt),\n          seekTimeoutDuration = arr[1];\n    playbackControlSeek(playback, stream, startedAt);\n    await props.dispatch({ type: 'playback/addToQueueReschedule' });\n\n    // schedule seek\n    if(seekTimeoutDuration) {\n      const seekTimeoutId = setTimeout(() => {\n        seek();\n      }, seekTimeoutDuration);\n      // setNextSeekTimeoutId(seekTimeoutId);\n      props.dispatch({\n        type: 'playback/nextSeekScheduled',\n        payload: { nextSeekTimeoutId: seekTimeoutId },\n      });\n    }\n\n    await props.dispatch({ type: 'playback/enable' });\n  }\n\n  /*\n   * Toggling the player from the \"playing\" to \"paused\" state.\n   */\n  const pause = async function() {\n    if(!stream.nowPlaying) {\n      return;\n    }\n    await props.dispatch({ type: 'playback/disable' });\n    const jsonResponse = await fetchPauseTrack(stream.nowPlaying.totalDurationMilliseconds);\n    await props.dispatch(jsonResponse.redux);\n    await props.dispatch({ type: 'playback/addToQueueReschedule' });\n    playbackControlPause(playback, stream);\n    clearTimeout(plannedNextTrackTimeoutId);\n    await props.dispatch({ type: 'playback/enable' });\n  }\n\n  /*\n   * Toggling the player from the \"paused\" to \"playing\" state.\n   */\n  const play = async function() {\n    await props.dispatch({ type: 'playback/disable' });\n    const jsonResponse = await fetchPlayTrack();\n    await props.dispatch(jsonResponse.redux);\n\n    // When page loads with the player in the \"paused\" state and then the user\n    // toggles to the \"playing\" state.\n    if(!playback.isPlaying) {\n      await props.dispatch({ type: 'playback/enable' });\n      return;\n    }\n\n    await props.dispatch({ type: 'playback/addToQueueReschedule' });\n    playbackControlPlay(playback, stream);\n    await props.dispatch({ type: 'playback/enable' });\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  // LOAD SPOTIFY SDK\n  useEffect(() => {\n    appendSpotifySDK();\n    appendAppleMusicSDK();\n  }, []);\n\n  useEffect(() => {\n    if(!appleMusicSDKReady) {\n      return;\n    }\n\n    fetchGetUserSettings()\n      .then(responseJson => {\n        const player = window.MusicKit.configure({\n          developerToken: responseJson.data.appleMusic.token,\n          app: {\n            name: 'Jukebox Radio',\n            build: '0.0.1',\n          },\n        });\n\n        player.addEventListener('mediaPlaybackError', function(e) {\n          console.log(\"mediaPlaybackError\");\n          console.log(e)\n        });\n\n        player.addEventListener(\"playbackStateDidChange\", function(e) {\n          console.log(\"playbackStateDidChange\")\n          console.log(e)\n        })\n\n        props.dispatch({\n          type: 'playback/appleMusic',\n          payload: { appleMusicApi: player },\n        });\n      });\n  // eslint-disable-next-line\n  }, [appleMusicSDKReady])\n\n  //////////////////////////////////////////////////////////////////////////////\n  // SPOTIFY SDK LOADED\n  // Happens on page load\n  useEffect(() => {\n    if(!spotifySDKReady) {\n      return;\n    }\n    // 7: Get user settings.\n    const player = new window.Spotify.Player({\n      name: 'Jukebox Radio',\n      getOAuthToken: cb => {\n        fetchGetUserSettings()\n          .then(responseJson => {\n            cb(responseJson.data.spotify.accessToken);\n            props.dispatch({\n              type: 'user/get-settings',\n              userSettings: responseJson.data,\n            });\n\n            // Initialize the Spotify player (conditionally).\n            const spotifyAccessToken = responseJson.data.spotify.accessToken;\n            if(spotifyAccessToken) {\n              const spotifyApi = new SpotifyWebApi();\n              spotifyApi.setAccessToken(responseJson.data.spotify.accessToken);\n              props.dispatch({\n                type: 'playback/spotify',\n                payload: { spotifyApi: spotifyApi },\n              });\n            }\n\n            // Enable playback controls.\n            props.dispatch({ type: 'playback/enable' });\n\n            setSpotifySDKInit(true);\n          });\n      }\n    });\n    player.addListener('ready', ({ device_id }) => {\n      setSpotifySDKDeviceID(device_id);\n    });\n    player.addListener('player_state_changed', (state) => {\n      return;\n      // if(state.duration) {\n      //   if(state.paused) {\n      //     setSpotifyIsPaused(true);\n      //   } else {\n      //     setSpotifyIsPlaying(true);\n      //   }\n      // } else {\n      //   setSpotifyIsPaused(false);\n      //   setSpotifyIsPlaying(false);\n      // }\n      // console.log(state);\n    });\n    player.connect();\n\n  // eslint-disable-next-line\n  }, [spotifySDKReady]);\n\n  //////////////////////////////////////////////////////////////////////////////\n  // Update player to SDK player\n  useEffect(() => {\n    if(!spotifySDKInit || !spotifySDKDeviceID) {\n      return;\n    }\n\n    updateSpotifyPlayer(playback, spotifySDKDeviceID);\n  // eslint-disable-next-line\n  }, [spotifySDKInit, spotifySDKDeviceID])\n\n  //////////////////////////////////////////////////////////////////////////////\n  // SCHEDULE ADD TO QUEUE\n  // Happens near the end of the currently playing track.\n  useEffect(() => {\n\n    // debouncer\n    const needsToScheduleAddToQueue = (\n      stream.isPlaying &&\n      playback.isPlaying &&\n      !playback.addToQueueTimeoutId\n    );\n    if(!needsToScheduleAddToQueue) {\n      return;\n    }\n\n    if(!stream?.nowPlaying) {\n      return;\n    }\n\n    // schedule add to queue\n    const progress = Date.now() - stream.startedAt,\n          timeLeft = (\n            stream.nowPlaying.totalDurationMilliseconds - progress\n          ),\n          timeoutDuration = timeLeft - 5000;\n    const timeoutId = setTimeout(() => {\n      addToQueue();\n    }, timeoutDuration);\n    props.dispatch({\n      type: 'playback/addToQueueScheduled',\n      payload: { addToQueueTimeoutId: timeoutId },\n    });\n\n    // schedule seek\n    const arr = getPositionMilliseconds(stream, stream.startedAt),\n          seekTimeoutDuration = arr[1];\n    if(seekTimeoutDuration) {\n      const seekTimeoutId = setTimeout(() => {\n        seek();\n      }, seekTimeoutDuration);\n      // setNextSeekTimeoutId(seekTimeoutId);\n      props.dispatch({\n        type: 'playback/nextSeekScheduled',\n        payload: { nextSeekTimeoutId: seekTimeoutId },\n      });\n    }\n\n  // eslint-disable-next-line\n  }, [playback]);\n\n  //////////////////////////////////////////////////////////////////////////////\n  // SCHEDULE PLANNED NEXT TRACK\n  // Happens at the very end of the currently playing track.\n  useEffect(() => {\n\n    // debouncer\n    if(!messageScheduleNextTrack) {\n      return;\n    }\n    setMessageScheduleNextTrack(false);\n\n    // schedule next track\n    const progress = Date.now() - stream.startedAt,\n          timeoutDuration = (\n            stream.nowPlaying.totalDurationMilliseconds - progress\n          );\n    const timeoutId = setTimeout(() => {\n      plannedNextTrack();\n    }, timeoutDuration);\n    clearTimeout(plannedNextTrackTimeoutId);\n    setPlannedNextTrackTimeoutId(timeoutId);\n\n  // eslint-disable-next-line\n  }, [messageScheduleNextTrack]);\n\n  //////////////////////////////////////////////////////////////////////////////\n  // Play the music.\n  useEffect(() => {\n    if(stream.isPlaying && !playback.isPlaying && playback.isReady) {\n      start();\n    }\n  // eslint-disable-next-line\n  }, [stream, playback]);\n\n\n  const playbackControls = { nextTrack, prevTrack, seek, pause, play };\n\n  const opts = {\n          height: '135',\n          width: '240',\n          playerVars: {\n            // https://developers.google.com/youtube/player_parameters\n            autoplay: 0,  // the initial video will automatically start to play\n            controls: 0,  // hide playback controls\n            disablekb: 1,  // disable keyboard controls\n            fs: 0,  // disable full screen\n            iv_load_policy: 3,\n            modestbranding: 1,\n            origin: 'jukeboxrad.io',\n            playsinline: 1,\n          },\n        },\n        videoId = stream?.nowPlaying?.track?.externalId;\n\n  const onYouTubeReady = function(e) {\n    const youTubeApi = e.target;\n    props.dispatch({\n      type: 'playback/youTube',\n      payload: { youTubeApi: youTubeApi },\n    });\n  }\n\n  const onYouTubePause = function() {\n    if(!stream.isPaused) {\n      pause();\n    }\n  }\n\n  const onYouTubePlay = function() {\n    if(!stream.isPlaying) {\n      play();\n    }\n  }\n\n  /*\n   * \n   */\n  return (\n    <>\n      <div style={{ display: 'none' }}>\n        <YouTube videoId={videoId}\n                 opts={opts}\n                 onReady={onYouTubeReady}\n                 onPause={onYouTubePause}\n                 onPlay={onYouTubePlay} />\n      </div>\n      <MainApp playbackControls={playbackControls}/>\n    </>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n    stream: state.stream,\n    playback: state.playback,\n    lastUpQueues: state.lastUpQueues,\n    nextUpQueues: state.nextUpQueues,\n    userSettings: state.userSettings,\n});\n\nexport default connect(mapStateToProps)(PlaybackApp);\n","import './App.css';\nimport {\n  fetchTextCommentList,\n  fetchVoiceRecordingList,\n} from './components/FeedApp/network';\nimport { fetchVerifyToken } from './components/Login/network';\nimport {\n  fetchStreamGet,\n  fetchPauseTrack,\n  fetchTrackGetFiles,\n} from './components/PlaybackApp/Player/network';\nimport { fetchQueueList } from './components/QueueApp/network'\nimport { playbackControlPause } from './components/PlaybackApp/controls';\nimport { store } from './utils/redux'\nimport Login from './components/Login/Login';\nimport PlaybackApp from './components/PlaybackApp/PlaybackApp';\nimport { useEffect, useState } from \"react\";\nimport { Provider } from 'react-redux';\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport { SERVICE_JUKEBOX_RADIO } from './config/services';\nimport TimeAgo from 'javascript-time-ago'\nimport en from 'javascript-time-ago/locale/en'\n\n\nfunction App() {\n\n  // Keeps track of the status of the webpage\n  //\n  //    - initial:          When the page is first loaded\n  //    - unauthenticated:  The client does NOT have a valid access token\n  //    - authenticated:    The client has a valid access token\n  //    - ready:            All API data has been loaded\n  const [status, setStatus] = useState('initial');\n\n  //////////////////////\n  // componentDidMount\n  useEffect(() => {\n    async function loadData() {\n      let responseJson;\n\n      // 1: Verify authentication.\n      const authResponse = await fetchVerifyToken();\n      if (!authResponse) {\n        setStatus('unauthenticated');\n        return;\n      }\n\n      // Update status.\n      setStatus('authenticated');\n\n      // 2: Load stream.\n      responseJson = await fetchStreamGet();\n      await store.dispatch(responseJson.redux);\n\n      // 3: Load the track now playing (conditionally).\n      const payload = responseJson.redux.payload,\n            nowPlayingTrack = payload.stream.nowPlaying?.track;\n      if(nowPlayingTrack?.service === SERVICE_JUKEBOX_RADIO) {\n        const trackUuid = nowPlayingTrack.uuid;\n        responseJson = await fetchTrackGetFiles(trackUuid);\n        await store.dispatch(responseJson.redux);\n        // NOTE: the above only works in production setups. This is because of\n        // how the file is served. the below setup can be adapted for a local\n        // setup.\n        //\n        // var request = new XMLHttpRequest();\n        // request.open(\"GET\", responseJson.redux.payload.track.audioUrl, true);\n        // request.responseType = \"blob\";\n        // request.onload = () => {\n        //   if(this.status !== 200) {\n        //     return;\n        //   }\n        //   const audio = new Audio(URL.createObjectURL(this.response));\n        //   responseJson.redux.payload.track.audio = audio;\n        //   store.dispatch(responseJson.redux);\n        // }\n        // request.send();\n      }\n\n      // 4: Load the queue.\n      responseJson = await fetchQueueList();\n      await store.dispatch(responseJson.redux);\n\n      // 5: Load relevant comments.\n      const textCommentsJsonResponse = await fetchTextCommentList(payload.stream.nowPlaying?.track?.uuid);\n      await store.dispatch(textCommentsJsonResponse.redux);\n\n      // 6: Load relevant voice recordings. This will also generate the feed.\n      const voiceRecordingsJsonResponse = await fetchVoiceRecordingList(payload.stream.nowPlaying?.track?.uuid);\n      await store.dispatch(voiceRecordingsJsonResponse.redux);\n\n      // Update status.\n      setStatus('ready');\n    }\n    TimeAgo.addDefaultLocale(en);\n    loadData();\n\n    // Define behavior for when the webpage is closed.\n    window.addEventListener(\"beforeunload\", (e) => {\n      e.preventDefault();\n      const state = store.getState();\n      if(!state.stream.isPlaying) {\n        return;\n      }\n      fetchPauseTrack();\n      playbackControlPause(state.playback, state.stream);\n    });\n  }, []);\n\n  // When the page is initially loaded, display nothing.\n  if(status === 'initial') {\n    return <></>;\n  }\n\n  // If the user is NOT authenticated, display the login portal.\n  if(status === 'unauthenticated') {\n    return (\n      <Router>\n        <Provider store={store}>\n          <div className=\"app-main-container\">\n            <div className=\"app-main\">\n              <Login />\n            </div>\n          </div>\n        </Provider>\n      </Router>\n    )\n  }\n\n  // if the user is not authenticated, only display the login portal\n  if(status === 'authenticated') {\n    return (\n      <Router>\n        <Provider store={store}>\n          Loading...\n        </Provider>\n      </Router>\n    )\n  }\n\n  // display the main UI now that everything is loaded up\n\n  /*\n   * \n   */\n  return (\n    <Router>\n      <Provider store={store}>\n        <div className=\"app-main-container\">\n          <PlaybackApp />\n        </div>\n      </Provider>\n    </Router>\n  );\n}\n\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"SideBar\":\"SideBar_SideBar__2JzAY\",\"Logo\":\"SideBar_Logo__3Rpb1\",\"Jb\":\"SideBar_Jb__7bttp\",\"Menu\":\"SideBar_Menu__2AXUO\",\"Search\":\"SideBar_Search__3Nyec\",\"Queue\":\"SideBar_Queue__17nHt\",\"Player\":\"SideBar_Player__1PY5E\",\"Feed\":\"SideBar_Feed__1PPpo\",\"Settings\":\"SideBar_Settings__2re0B\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Upload\":\"Upload_Upload__tMDig\",\"FormBlock\":\"Upload_FormBlock__2ls6S\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"QueueCollection\":\"QueueCollection_QueueCollection__2uTSJ\",\"Item\":\"QueueCollection_Item__2k6HI\",\"Button\":\"QueueCollection_Button__KLnuj\",\"Children\":\"QueueCollection_Children__1Q1i5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"SearchApp\":\"SearchApp_SearchApp__Mfcqz\",\"SearchBar\":\"SearchApp_SearchBar__CS1zo\",\"FormBlock\":\"SearchApp_FormBlock__1myUf\",\"SearchResults\":\"SearchApp_SearchResults__p1J6y\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Login\":\"Login_Login__1ujut\",\"FormBlock\":\"Login_FormBlock__S_rix\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"SearchResult\":\"SearchResult_SearchResult__djXCo\",\"Button\":\"SearchResult_Button__1Hbjl\",\"ggSpinner\":\"SearchResult_ggSpinner__iNeQG\",\"spinner\":\"SearchResult_spinner__u3axZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"WelcomeApp\":\"WelcomeApp_WelcomeApp__3mJcH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"FirstInterval\":\"ChildProgressBar_FirstInterval__1gNR-\",\"LastInterval\":\"ChildProgressBar_LastInterval__2llh2\",\"ProgressParentBare\":\"ChildProgressBar_ProgressParentBare__3_wH6\",\"ProgressParentMuted\":\"ChildProgressBar_ProgressParentMuted__2Yfxu\",\"ProgressAll\":\"ChildProgressBar_ProgressAll__2IIt8\",\"ProgressMute\":\"ChildProgressBar_ProgressMute__3zy-Z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"FeedApp\":\"FeedApp_FeedApp__2YJHa\",\"Feed\":\"FeedApp_Feed__3NWaq\",\"FeedWrapper\":\"FeedApp_FeedWrapper__5dQdY\",\"CreateTextComment\":\"FeedApp_CreateTextComment__1tCDm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"QueueTrack\":\"QueueTrack_QueueTrack__cD3iI\",\"Button\":\"QueueTrack_Button__3peLA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ProgressBar\":\"ParentProgressBar_ProgressBar__uCese\",\"ProgressPointer\":\"ParentProgressBar_ProgressPointer__2qz3g\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"QueueApp\":\"QueueApp_QueueApp__3OUXI\",\"AddToQueue\":\"QueueApp_AddToQueue__1Zpmd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MiniQueue\":\"MiniQueue_MiniQueue__2HfJP\",\"MiniQueueItem\":\"MiniQueue_MiniQueueItem__2-wsK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"NotableText\":\"NotableText_NotableText__gYPiJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"TextComment\":\"TextComment_TextComment__92FmQ\",\"Notated\":\"TextComment_Notated__8XL21\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ABCNotationDisplay\":\"ABCNotationDisplay_ABCNotationDisplay__2WbrS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"VoiceRecording\":\"VoiceRecording_VoiceRecording__29j03\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MiniFeed\":\"MiniFeed_MiniFeed__2GXUK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MiniPlayer\":\"MiniPlayer_MiniPlayer__w1Mms\",\"Image\":\"MiniPlayer_Image__1dVlH\"};"],"sourceRoot":""}